<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hmotnostní a tepelné bilance procesních systémů</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* KRITICKÁ SPECIFIKACE PRO OUTPUT STYLE - POVINNÉ DODRŽOVÁNÍ */
        
        /* ZÁKLADNÍ PRAVIDLO: PREZENTACE MUSÍ FUNGOVAT JAKO POWERPOINT
           - Vše musí být vždy viditelné (normální i fullscreen režim)
           - Při fullscreen pouze zvětšení, stejné pozice
           - Žádné overflow, žádné scrollování, nikdy
           - Page counter vždy viditelný
           - Obsah musí být navržen tak, aby se vešel do slide
           - Pokud se nevleze → rozdělit na více slajdů nebo použít záložky
           - Interaktivní výsledky MUSÍ být na samostatné záložce "Výsledky"
           - Titulní slide musí mít větší písma (h1: 4rem, h2: 2.8rem)
           - Rozložení volit podle obsahu (nejen dvouslopcové)
        */

        :root {
            --bg-main: #f8f9fa;
            --bg-slide: #ffffff;
            --color-h: #003f88;
            --color-accent: #0056b3;
            --color-text: #212529;
            --bg-practice: #e6f7ff;
            --border-practice: #1890ff;
            --bg-formula: #eef2f7;
            --border-formula: #0056b3;
        }
        
        /* KRITICKÉ: Statické výsledkové oblasti - NIKDY NEMĚNIT LAYOUT! */
        .calc-result {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
            padding: 1rem;
            background-color: #f0f8ff;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: block; /* Vždy block, nikdy none! */
        }
        
        .calc-result.visible {
            visibility: visible;
            opacity: 1;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-main);
            color: var(--color-text);
            overflow: hidden;
            font-size: 24px;
        }
        
        #presentation-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ZÁKLADNÍ SLIDE - FIXNÍ POMĚR STRAN 16:9 */
        .slide {
            position: absolute;
            width: 90vw;
            height: 90vh;
            aspect-ratio: 16 / 9;
            max-width: calc(90vh * 16/9); /* Zachová poměr stran */
            max-height: 90vh;
            background-color: var(--bg-slide);
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.95);
            transition: opacity 0.4s ease, visibility 0.4s ease, transform 0.4s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* KRITICKÉ: Žádné scrollování */
        }

        .slide.active {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }

        /* FULLSCREEN - POUZE ZVĚTŠENÍ, STEJNÉ POZICE */
        #presentation-container:fullscreen .slide,
        #presentation-container:-webkit-full-screen .slide,
        #presentation-container:-moz-full-screen .slide,
        #presentation-container:-ms-fullscreen .slide {
            width: 95vw;
            height: 95vh;
            max-width: calc(95vh * 16/9);
            max-height: 95vh;
            border-radius: 0.5rem;
            padding: 2.5rem;
        }

        /* NADPISY - PROPORCIONÁLNÍ VELIKOSTI */
        .slide h2 {
            color: var(--color-h);
            font-size: 2.2rem;
            font-weight: 700;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--color-accent);
            margin-bottom: 1.5rem;
            flex-shrink: 0;
        }
        
        .slide h3 {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--color-h);
            margin-bottom: 0.8rem;
        }
        
        /* OBSAH SLAJDU - FLEXIBILNÍ ROZLOŽENÍ */
        .slide-content {
            flex-grow: 1;
            display: flex;
            gap: 1.5rem;
            overflow: hidden; /* KRITICKÉ: Žádné scrollování */
            padding-bottom: 50px; /* Prostor pro zápatí */
            /* POVINNÉ: VŠE MUSÍ BÝT VIDĚT I BEZ FULLSCREENU */
            height: calc(100% - 50px); /* Vždy se vejde */
        }
        
        /* KOMPAKTNÍ REŽIM - pro slajdy s mnoha boxy */
        .slide.compact .slide-content {
            gap: 1rem;
            padding-bottom: 40px;
        }
        
        .slide.compact .practice-box,
        .slide.compact .formula-box,
        .slide.compact .info-box {
            padding: 0.6rem 1rem;
            margin: 0.5rem 0;
        }
        
        .slide.compact .practice-box h3,
        .slide.compact .formula-box h3,
        .slide.compact .info-box h3 {
            margin-bottom: 0.3rem;
            font-size: 1.1rem;
        }
        
        .slide.compact p {
            margin-bottom: 0.5rem;
        }
        
        .slide.compact ul {
            margin: 0.3rem 0;
        }
        
        /* ULTRA-KOMPAKTNÍ REŽIM - pro velmi hustý obsah */
        .slide.ultra-compact .slide-content {
            gap: 0.8rem;
            padding-bottom: 35px;
        }
        
        .slide.ultra-compact .practice-box,
        .slide.ultra-compact .formula-box,
        .slide.ultra-compact .info-box {
            padding: 0.4rem 0.8rem;
            margin: 0.3rem 0;
        }
        
        .slide.ultra-compact .practice-box h3,
        .slide.ultra-compact .formula-box h3,
        .slide.ultra-compact .info-box h3 {
            margin-bottom: 0.2rem;
            font-size: 1rem;
        }
        
        .slide.ultra-compact p {
            margin-bottom: 0.3rem;
            font-size: 0.95rem;
            line-height: 1.3;
        }
        
        .slide.ultra-compact ul {
            margin: 0.2rem 0;
        }
        
        .slide.ultra-compact ul li {
            margin-bottom: 0.1rem;
            font-size: 0.95rem;
        }
        
        /* ULTRA-COMPACT pro custom boxy (chyby, tipy) */
        .slide.ultra-compact div[style*="background-color: #ffebee"],
        .slide.ultra-compact div[style*="background-color: #e8f5e8"] {
            padding: 0.5rem !important;
            margin: 0.4rem 0 !important;
        }
        
        .slide.ultra-compact h4 {
            margin-bottom: 0.2rem;
            font-size: 0.95rem;
        }
        
        .slide.ultra-compact .two-column {
            gap: 1rem;
        }
        
        /* STYLY PRO INTERAKTIVNÍ PŘÍKLADY */
        .example-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .example-tab {
            padding: 0.5rem 1rem;
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 0.5rem 0.5rem 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .example-tab.active {
            background: white;
            border-color: var(--color-accent);
            color: var(--color-accent);
            font-weight: 600;
        }
        
        .example-tab:hover {
            background: #f0f0f0;
        }
        
        .example-content {
            display: none;
            padding: 1rem;
            background: white;
            border-radius: 0 0.5rem 0.5rem 0.5rem;
        }
        
        .example-content.active {
            display: block;
        }
        
        .example-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            height: 100%;
        }
        
        .process-schema {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        
        .example-calc {
            background: #f8f9fa;
            border-radius: 0.5rem;
            padding: 1rem;
        }
        
        .calc-inputs {
            display: grid;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .calc-input-row {
            display: grid;
            grid-template-columns: 1fr 80px 40px;
            gap: 0.5rem;
            align-items: center;
        }
        
        .legacy-calc-result {
            background: white;
            border: 2px solid var(--color-accent);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            display: none;
            max-height: 250px;
            overflow-y: auto;
        }
        
        .legacy-calc-result.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .example-warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 0.25rem;
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }
        
        .example-tip {
            background: #d1ecf1;
            border: 1px solid #17a2b8;
            border-radius: 0.25rem;
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }
        
        /* Na slajdech bez zápatí odstraníme extra prostor */
        .title-slide .slide-content,
        .final-slide .slide-content,
        .cheat-sheet .slide-content {
            padding-bottom: 0;
        }

        /* ROZLOŽENÍ PODLE OBSAHU */
        .layout-text-visual { /* Text vlevo, vizuál vpravo */
            flex-direction: row;
        }
        .layout-visual-text { /* Vizuál vlevo, text vpravo */
            flex-direction: row-reverse;
        }
        .layout-full { /* Celá šířka */
            flex-direction: column;
        }
        .layout-centered { /* Centrovaný obsah */
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .content-text { 
            flex: 3;
            overflow-y: auto; /* POVINNÉ: Umožní scrollování v textu pokud je potřeba */
            max-height: 100%;
            padding-right: 0.5rem;
        }
        .content-visual { 
            flex: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .content-full {
            flex: 1;
            overflow: hidden;
        }

        /* OBRÁZKY A GRAFY - RESPONZIVNÍ VELIKOSTI */
        .content-visual img, .content-visual canvas {
            width: 100%;
            height: 100%;
            min-width: 500px;
            min-height: 400px;
            max-width: 600px;
            max-height: 500px;
            object-fit: contain;
            border-radius: 0.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        /* SPECIÁLNÍ STYLY PRO TITULNÍ A ZÁVĚREČNÝ SNÍMEK */
        .title-slide, .final-slide {
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .title-slide h1, .final-slide h1 {
            font-size: 4rem;
            color: var(--color-h);
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .title-slide h2, .final-slide h2 {
            font-size: 2.8rem;
            color: var(--color-accent);
            border: none;
            margin-bottom: 1rem;
            font-weight: 500;
        }
        .title-slide p {
            font-size: 1.3rem;
            margin-top: 1rem;
        }

        /* BOXY - OPTIMALIZOVANÉ VELIKOSTI */
        .practice-box, .formula-box, .info-box {
            padding: 0.8rem 1.2rem;
            border-left-width: 4px;
            border-radius: 0.25rem;
            margin: 0.8rem 0;
        }
        .practice-box {
            background-color: var(--bg-practice);
            border-color: var(--border-practice);
        }
        .formula-box {
            background-color: var(--bg-formula);
            border-color: var(--border-formula);
        }
        .info-box {
            background-color: #fffbe6;
            border-color: #faad14;
        }
        .practice-box h3, .formula-box h3, .info-box h3 {
            font-weight: 700;
            color: var(--color-h);
            margin-bottom: 0.4rem;
            font-size: 1.2rem;
        }

        /* ZÁPATÍ SLAJDŮ */
        .slide-footer {
            position: absolute;
            bottom: 15px;
            left: 30px;
            right: 30px;
            height: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: var(--color-text);
            border-top: 1px solid #e0e0e0;
            padding-top: 8px;
            background-color: transparent;
        }
        
        .slide-footer .footer-left {
            font-weight: 500;
            color: var(--color-accent);
        }
        
        .slide-footer .footer-right {
            font-weight: 700;
            color: var(--color-h);
            background-color: rgba(0, 86, 179, 0.1);
            padding: 4px 12px;
            border-radius: 12px;
            border: 1px solid var(--color-accent);
        }
        
        /* Skrytí zápatí na titulním, závěrečném slajdu a souhrnu */
        .title-slide .slide-footer,
        .final-slide .slide-footer,
        .cheat-sheet .slide-footer {
            display: none;
        }

        /* ZÁPATÍ VE FULLSCREEN REŽIMU */
        #presentation-container:fullscreen .slide-footer,
        #presentation-container:-webkit-full-screen .slide-footer,
        #presentation-container:-moz-full-screen .slide-footer,
        #presentation-container:-ms-fullscreen .slide-footer {
            bottom: 20px;
            left: 40px;
            right: 40px;
            z-index: 1000;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px 20px 8px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        /* INPUT ELEMENTY A KALKULÁTORY */
        .input-group {
            margin-bottom: 0.8rem;
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .input-group label {
            font-weight: 500;
            color: var(--color-h);
            font-size: 0.9rem;
        }
        
        .input-group input,
        .calc-input,
        input[type="number"] {
            padding: 0.4rem 0.8rem;
            border: 2px solid #e1e5e9;
            border-radius: 0.4rem;
            font-size: 0.9rem;
            font-family: 'Inter', sans-serif;
            width: 100%;
            max-width: 150px;
            transition: border-color 0.2s ease;
        }
        
        .input-group input:focus,
        .calc-input:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: var(--color-accent);
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1);
        }
        
        .calc-button,
        button[onclick*="calculate"] {
            background-color: var(--color-accent);
            color: white;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .calc-button:hover,
        button[onclick*="calculate"]:hover {
            background-color: #004494;
            transform: translateY(-1px);
        }

        /* NAVIGACE - VŽDY VIDITELNÁ I V FULLSCREEN */
        .nav-arrow {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            width: 3rem;
            height: 3rem;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
            z-index: 2147483647; /* MAXIMÁLNÍ Z-INDEX */
            pointer-events: auto;
        }
        .nav-arrow:hover { background-color: var(--color-accent); }
        #prev-slide { left: 1rem; }
        #next-slide { right: 1rem; }

        /* PROGRESS BAR A PAGE COUNTER - MAXIMÁLNÍ PRIORITA */
        #progress-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            height: 4px;
            background-color: var(--color-accent);
            width: 0;
            transition: width 0.3s ease;
            z-index: 2147483647; /* MAXIMÁLNÍ Z-INDEX */
            pointer-events: none;
        }
        
        #page-counter {
            position: fixed;
            bottom: 1rem;
            right: 2rem;
            font-size: 1.2rem;
            background-color: rgba(0,0,0,0.9);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 1.5rem;
            z-index: 2147483647; /* MAXIMÁLNÍ Z-INDEX */
            font-weight: bold;
            border: 2px solid rgba(255,255,255,0.3);
            pointer-events: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        /* FULLSCREEN BUTTON - MAXIMÁLNÍ PRIORITA */
        #fullscreen-btn {
            position: fixed;
            top: 1rem;
            right: 1rem;
            width: 3rem;
            height: 3rem;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
            z-index: 2147483647; /* MAXIMÁLNÍ Z-INDEX */
            pointer-events: auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        #fullscreen-btn:hover { background-color: var(--color-accent); }

        /* FULLSCREEN STYLY - SKRYTÍ NAVIGAČNÍCH PRVKŮ */
        #presentation-container:fullscreen .nav-arrow,
        #presentation-container:-webkit-full-screen .nav-arrow,
        #presentation-container:-moz-full-screen .nav-arrow,
        #presentation-container:-ms-fullscreen .nav-arrow,
        #presentation-container:fullscreen #fullscreen-btn,
        #presentation-container:-webkit-full-screen #fullscreen-btn,
        #presentation-container:-moz-full-screen #fullscreen-btn,
        #presentation-container:-ms-fullscreen #fullscreen-btn {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
        }

        /* FULLSCREEN - POUZE PAGE COUNTER A PROGRESS BAR VIDITELNÉ */
        :fullscreen #page-counter,
        :-webkit-full-screen #page-counter,
        :-moz-full-screen #page-counter,
        :-ms-fullscreen #page-counter,
        #presentation-container:fullscreen #page-counter,
        #presentation-container:-webkit-full-screen #page-counter,
        #presentation-container:-moz-full-screen #page-counter,
        #presentation-container:-ms-fullscreen #page-counter {
            z-index: 999999999 !important;
            position: fixed !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            bottom: 2rem !important;
            right: 3rem !important;
            font-size: 2rem !important;
            background-color: #000000 !important;
            color: #ffffff !important;
            padding: 1rem 2rem !important;
            border-radius: 3rem !important;
            font-weight: 900 !important;
            border: 4px solid #ffffff !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8) !important;
            font-family: 'Inter', monospace !important;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8) !important;
            transform: none !important;
            margin: 0 !important;
            left: auto !important;
            top: auto !important;
            width: auto !important;
            height: auto !important;
            max-width: none !important;
            max-height: none !important;
            min-width: auto !important;
            min-height: auto !important;
        }

        :fullscreen #progress-bar,
        :-webkit-full-screen #progress-bar,
        :-moz-full-screen #progress-bar,
        :-ms-fullscreen #progress-bar,
        #presentation-container:fullscreen #progress-bar,
        #presentation-container:-webkit-full-screen #progress-bar,
        #presentation-container:-moz-full-screen #progress-bar,
        #presentation-container:-ms-fullscreen #progress-bar {
            z-index: 999999998 !important;
            position: fixed !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            bottom: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 8px !important;
            background-color: var(--color-accent) !important;
            transform: none !important;
            margin: 0 !important;
            top: auto !important;
            right: auto !important;
        }

        /* CHEAT SHEET */
        .cheat-sheet {
            padding: 1.5rem;
            overflow-y: auto;
            font-size: 16px;
        }
        .cheat-sheet h2 { 
            font-size: 2rem; 
            margin-bottom: 1rem; 
            color: var(--color-h);
            border-bottom: 3px solid var(--color-accent);
            padding-bottom: 0.5rem;
        }
        .cheat-sheet h3 { 
            font-size: 1.2rem; 
            margin-top: 1rem; 
            margin-bottom: 0.6rem; 
            color: var(--color-h); 
            border-bottom: 2px solid var(--color-accent); 
            padding-bottom: 0.2rem;
        }

        /* INTERAKTIVNÍ PRVKY */
        .interactive-calc {
            background-color: #f8f9fa;
            border: 2px solid var(--color-accent);
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 0.5rem 0;
        }

        .calc-input {
            margin: 0.3rem 0.5rem;
            padding: 0.4rem;
            border: 1px solid #ccc;
            border-radius: 0.25rem;
            width: 80px;
        }

        .calc-button {
            background-color: var(--color-accent);
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
            margin: 0.3rem;
            font-size: 0.9rem;
        }

        .calc-button:hover {
            background-color: var(--color-h);
        }

        .result {
            background-color: #e6f7ff;
            padding: 0.8rem;
            border-radius: 0.25rem;
            margin-top: 0.8rem;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* RESPONSIVE TEXT */
        p, li {
            font-size: 1rem;
            line-height: 1.4;
            margin-bottom: 0.5rem;
        }

        ul, ol {
            margin-left: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* GRID LAYOUTS */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            height: 100%;
        }

        .three-column {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="presentation-container">
        <!-- Snímek 1: Titulní -->
        <div class="slide title-slide active">
            <h1>Hmotnostní a tepelné bilance</h1>
            <h2>Procesních systémů</h2>
            <p>Komplexní přehled bilancování základních procesních jednotek</p>
            <p style="color: var(--color-accent); margin-top: 1rem;">Pro studenty magisterského studia technických oborů</p>
        </div>

        <!-- Snímek 2: Obsah -->
        <div class="slide">
            <h2>Obsah prezentace</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="two-column">
                        <div>
                            <ul class="list-disc space-y-3 pl-5">
                                <li><b>1. Základní principy bilancování:</b> Univerzální bilanční rovnice</li>
                                <li><b>2. Procesní aparáty:</b>
                                    <ul class="list-['–'] pl-4 mt-1 space-y-1">
                                        <li>Mísič (Mixer)</li>
                                        <li>Dělič proudu (Splitter)</li>
                                        <li>Dělič složek (Component Splitter)</li>
                                        <li>Výměník tepla (Heat Exchanger)</li>
                                        <li>Reaktor</li>
                                    </ul>
                                </li>
                                <li><b>3. Pokročilé koncepty:</b> Fázové změny, recykl</li>
                                <li><b>4. Systematická metodika řešení</b></li>
                            </ul>
                        </div>
                        <div>
                            <ul class="list-disc space-y-3 pl-5">
                                <li><b>5. Stupně volnosti (DOF)</b></li>
                                <li><b>6. Časté chyby a jejich prevence</b></li>
                                <li><b>7. Souhrn klíčových informací</b></li>
                            </ul>
                            
                            <div style="background-color: var(--bg-formula); padding: 1.5rem; border-radius: 0.8rem; margin-top: 1.5rem; text-align: center;">
                                <div style="font-size: 3rem; color: var(--color-accent); margin-bottom: 0.5rem;">⚖️</div>
                                <h3 style="color: var(--color-h); margin-bottom: 0.5rem;">Základní princip</h3>
                                <p style="font-weight: bold;">VSTUP + ZDROJ = VÝSTUP + SPOTŘEBA</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 3: Základní principy -->
        <div class="slide">
            <h2>1. Základní principy bilancování</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <p>Základem bilancování je <b>univerzální bilanční rovnice</b> pro jakoukoliv extenzivní veličinu:</p>
                    
                    <div class="formula-box">
                        <h3>Obecná bilanční rovnice</h3>
                        <div style="text-align: center; margin: 1rem 0; font-size: 0.9rem; line-height: 1.6;">
                            $$\text{VSTUP} - \text{VÝSTUP} + \text{ZDROJ} - \text{SPOTŘEBA}$$
                            $$= \text{AKUMULACE}$$
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>Ustálený stav</h3>
                        <p>AKUMULACE = 0:</p>
                        $$\text{VSTUP} + \text{ZDROJ} = \text{VÝSTUP} + \text{SPOTŘEBA}$$
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="balanceScheme" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 4: Mísič -->
        <div class="slide">
            <h2>2.1 Mísič (Mixer)</h2>
            <div class="slide-content layout-visual-text">
                <div class="content-visual">
                    <canvas id="mixerDiagram" width="500" height="400"></canvas>
                </div>
                <div class="content-text">
                    <p><b>Princip:</b> Smíchání vstupních proudů bez chemické reakce.</p>

                    <div class="formula-box">
                        <h3>Hmotnostní bilance</h3>
                        <p><b>Celková:</b> $\dot{m}_1 + \dot{m}_2 = \dot{m}_3$</p>
                        <p><b>Složková:</b></p>
                        $$\dot{m}_1 \cdot x_{A,1} + \dot{m}_2 \cdot x_{A,2} = \dot{m}_3 \cdot x_{A,3}$$
                    </div>

                    <div class="formula-box">
                        <h3>Tepelná bilance</h3>
                        $$\dot{m}_1 h_1 + \dot{m}_2 h_2 = \dot{m}_3 h_3$$
                        <p>Pro stejné $c_p$: $T_3 = \frac{\dot{m}_1 T_1 + \dot{m}_2 T_2}{\dot{m}_1 + \dot{m}_2}$</p>
                    </div>

                    <div class="practice-box">
                        <h3>Aplikace</h3>
                        <p>Míchání surovin, blending produktů, míchání frakcí</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 5: Mísič - příklad -->
        <div class="slide">
            <h2>2.1 Mísič - Interaktivní příklad</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="interactive-calc">
                        <h3 style="text-align: center; margin-bottom: 1rem;">Kalkulátor míchání vody</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; align-items: start;">
                            <div>
                                <h4><b>Proud 1:</b></h4>
                                <div>Průtok (kg/s): <input type="number" id="mixer-m1" class="calc-input" value="2" min="0"></div>
                                <div>Teplota (°C): <input type="number" id="mixer-t1" class="calc-input" value="80" min="0"></div>
                                
                                <h4 style="margin-top: 1rem;"><b>Proud 2:</b></h4>
                                <div>Průtok (kg/s): <input type="number" id="mixer-m2" class="calc-input" value="3" min="0"></div>
                                <div>Teplota (°C): <input type="number" id="mixer-t2" class="calc-input" value="20" min="0"></div>
                                
                                <button class="calc-button" onclick="calculateMixer()" style="margin-top: 1rem; font-size: 1rem; padding: 0.7rem 1.5rem;">Vypočítej</button>
                            </div>
                            
                            <div id="mixer-result" class="calc-result" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Výsledky míchání</h4>
                                
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                    <p><b>Průtok výstup:</b> <span id="mixer-flow" style="font-weight: bold; color: #003f88;">---</span> kg/s</p>
                                    <p><b>Teplota výstup:</b> <span id="mixer-temp" style="font-weight: bold; color: #003f88;">---</span> °C</p>
                                </div>
                                
                                <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem;">
                                    <b>Kontrola bilance:</b><br>
                                    <span id="mixer-check-mass" style="font-weight: bold;">---</span><br>
                                    <span id="mixer-check-temp" style="font-weight: bold;">---</span>
                                </div>
                            </div>
                            
                            <div style="background-color: var(--bg-formula); padding: 1rem; border-radius: 0.4rem;">
                                <h4 style="color: var(--color-h); margin-bottom: 0.5rem;">Použité vzorce:</h4>
                                <p><b>Hmotnost:</b> $\dot{m}_3 = \dot{m}_1 + \dot{m}_2$</p>
                                <p><b>Teplota:</b> $T_3 = \frac{\dot{m}_1 T_1 + \dot{m}_2 T_2}{\dot{m}_3}$</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 6: Dělič proudu -->
        <div class="slide ultra-compact">
            <h2>2.2 Dělič proudu (Splitter)</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <p><b>Princip:</b> Rozdělení jednoho proudu na více proudů <b>se stejným složením a teplotou</b>.</p>

                    <div class="formula-box">
                        <h3>Hmotnostní bilance</h3>
                        $$\dot{m}_1 = \dot{m}_2 + \dot{m}_3$$
                        <p><b>Klíčová vlastnost:</b></p>
                        $$x_{A,1} = x_{A,2} = x_{A,3}$$
                        $$T_1 = T_2 = T_3$$
                    </div>

                    <div class="info-box">
                        <h3>Charakteristiky</h3>
                        <p>Nejjednodušší procesní jednotka - zachovává všechny intenzivní vlastnosti.</p>
                    </div>

                    <div class="practice-box">
                        <h3>Praktické aplikace</h3>
                        <ul class="list-disc pl-5">
                            <li>Rozdělovače v potrubí</li>
                            <li>Bypass linie</li>
                            <li>Paralelní reaktory</li>
                        </ul>
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="splitterDiagram" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 7: Separátor složek -->
        <div class="slide compact">
            <h2>2.3 Separátor složek (Component Separator)</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <p><b>Princip:</b> Rozdělení jednoho proudu na více proudů <b>s odlišným složením</b>, ale stejnou teplotou. Jednotlivé složky jsou oddělené podle specifikovaného poměru.</p>

                    <div class="formula-box">
                        <h3>Hmotnostní bilance</h3>
                        <p><b>Celková:</b> $\dot{m}_1 = \dot{m}_2 + \dot{m}_3$</p>
                        <p><b>Složková (pro složku A):</b></p>
                        $$\dot{m}_{A,1} = \dot{m}_{A,2} + \dot{m}_{A,3}$$
                        <p>kde $\dot{m}_{A,2} = \alpha \cdot \dot{m}_{A,1}$ a $\dot{m}_{A,3} = (1-\alpha) \cdot \dot{m}_{A,1}$</p>
                        <p>$\alpha$ = podíl složky A jdoucí do proudu 2</p>
                    </div>

                    <div class="info-box">
                        <h3>Tepelná bilance</h3>
                        <p>Teplota se nemění: $T_1 = T_2 = T_3$</p>
                        <p>Redukuje se na celkovou hmotnostní bilanci.</p>
                    </div>

                    <div class="practice-box">
                        <h3>Aplikace</h3>
                        <ul class="list-disc pl-5">
                            <li>Fiktivní jednotka - nahrazuje destilační kolonu</li>
                            <li>Membránové separátory</li>
                            <li>Chromatografické kolony</li>
                        </ul>
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="componentSeparatorSchema" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 8: Separátor složek - Interaktivní příklad -->
        <div class="slide">
            <h2>2.3 Separátor složek - Interaktivní příklad</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="two-column">
                        <div>
                            
                            <div class="practice-box">
                                <h3>🧮 Výpočet separátoru složek</h3>
                                <div class="input-group">
                                    <label for="divider-m1">Vstupní průtok (kg/s):</label>
                                    <input type="number" id="divider-m1" value="100" step="0.1">
                                </div>
                                <div class="input-group">
                                    <label for="divider-conc">Koncentrace A (%):</label>
                                    <input type="number" id="divider-conc" value="40" step="1" min="0" max="100">
                                </div>
                                <div class="input-group">
                                    <label for="divider-split-a">Separace A do proudu 2 (%):</label>
                                    <input type="number" id="divider-split-a" value="80" step="1" min="0" max="100">
                                </div>
                                <div class="input-group">
                                    <label for="divider-split-b">Separace B do proudu 2 (%):</label>
                                    <input type="number" id="divider-split-b" value="30" step="1" min="0" max="100">
                                </div>
                                <div class="input-group">
                                    <label for="divider-temp">Teplota (°C):</label>
                                    <input type="number" id="divider-temp" value="80" step="1">
                                </div>
                                <button onclick="calculateDivider()" class="calc-button">Vypočítat</button>
                            </div>
                        </div>
                        <div>
                            <div class="calc-result" id="divider-results" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Výsledky separace</h4>
                                
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                    <h5 style="color: #0056b3; margin-bottom: 0.5rem;">PROUD 2 (Koncentrát):</h5>
                                    <p><b>Průtok:</b> <span id="div-m2" style="font-weight: bold; color: #003f88;">---</span> kg/s</p>
                                    <p>• Složka A: <span id="div-a2" style="font-weight: bold; color: #d32f2f;">---</span>% (<span id="div-a2-kg" style="font-weight: bold;">---</span> kg/s)</p>
                                    <p>• Složka B: <span id="div-b2" style="font-weight: bold; color: #1976d2;">---</span>% (<span id="div-b2-kg" style="font-weight: bold;">---</span> kg/s)</p>
                                </div>
                                
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                    <h5 style="color: #0056b3; margin-bottom: 0.5rem;">PROUD 3 (Zbytek):</h5>
                                    <p><b>Průtok:</b> <span id="div-m3" style="font-weight: bold; color: #003f88;">---</span> kg/s</p>
                                    <p>• Složka A: <span id="div-a3" style="font-weight: bold; color: #d32f2f;">---</span>% (<span id="div-a3-kg" style="font-weight: bold;">---</span> kg/s)</p>
                                    <p>• Složka B: <span id="div-b3" style="font-weight: bold; color: #1976d2;">---</span>% (<span id="div-b3-kg" style="font-weight: bold;">---</span> kg/s)</p>
                                </div>
                                
                                <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem; margin-bottom: 0.8rem;">
                                    <p><b>Teplota všech proudů:</b> <span id="div-temp" style="font-weight: bold;">---</span> °C</p>
                                </div>
                                
                                <div style="background: #fff3e0; padding: 0.8rem; border-radius: 0.5rem;">
                                    <p style="margin-bottom: 0.3rem;"><b>Kontrola bilance:</b></p>
                                    <p style="font-size: 0.9em; margin-bottom: 0.2rem;">Celková: <span id="div-check-total" style="font-weight: bold;">---</span></p>
                                    <p style="font-size: 0.9em; margin-bottom: 0;">Složka A: <span id="div-check-a" style="font-weight: bold;">---</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 9: Výměník tepla -->
        <div class="slide compact">
            <h2>2.4 Výměník tepla (Heat Exchanger)</h2>
            <div class="slide-content layout-visual-text">
                <div class="content-visual">
                    <canvas id="heatExchangerDiagram" width="500" height="400"></canvas>
                </div>
                <div class="content-text">
                    <p><b>Princip:</b> Přenos tepla mezi oddělenými proudy.</p>

                    <div class="formula-box">
                        <h3>Hmotnostní bilance</h3>
                        <p>Triviální - proudy oddělené:</p>
                        <p>$\dot{m}_{h,in} = \dot{m}_{h,out}$</p>
                        <p>$\dot{m}_{c,in} = \dot{m}_{c,out}$</p>
                    </div>

                    <div class="formula-box">
                        <h3>Tepelná bilance</h3>
                        <p><b>Základní princip:</b> $Q_h = Q_c$</p>
                        $$\dot{m}_h c_{p,h} (T_{h,in} - T_{h,out}) = \dot{m}_c c_{p,c} (T_{c,out} - T_{c,in})$$
                    </div>

                    <div class="practice-box">
                        <h3>Typy</h3>
                        <ul class="list-disc pl-5">
                            <li>Trubkový (shell & tube)</li>
                            <li>Deskový</li>
                            <li>Spirálový</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 9: Výměník tepla - příklad -->
        <div class="slide">
            <h2>2.4 Výměník tepla - Interaktivní příklad</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="interactive-calc">
                        <h3 style="text-align: center; margin-bottom: 1rem;">Kalkulátor výměníku tepla - ohřev vody</h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; align-items: start;">
                            <div>
                                <h4><b>Horký proud:</b></h4>
                                <div>Průtok (kg/s): <input type="number" id="hex-mh" class="calc-input" value="5" min="0"></div>
                                <div>T vstup (°C): <input type="number" id="hex-th1" class="calc-input" value="90" min="0"></div>
                                <div>T výstup (°C): <input type="number" id="hex-th2" class="calc-input" value="50" min="0"></div>
                                
                                <h4 style="margin-top: 1rem;"><b>Studený proud:</b></h4>
                                <div>Průtok (kg/s): <input type="number" id="hex-mc" class="calc-input" value="3" min="0"></div>
                                <div>T vstup (°C): <input type="number" id="hex-tc1" class="calc-input" value="25" min="0"></div>
                                
                                <button class="calc-button" onclick="calculateHeatExchanger()" style="margin-top: 1rem; font-size: 1rem; padding: 0.7rem 1.5rem;">Vypočítej T výstup</button>
                            </div>
                            
                            <div id="hex-results" class="calc-result" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Výsledky výměníku tepla</h4>
                                
                                <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                    <p><b>Horký proud:</b> Odevzdalo <span id="hex-qh" style="font-weight: bold; color: #d32f2f;">---</span> kW</p>
                                    <p><b>Studený proud:</b> Výstupní teplota <span id="hex-tc2" style="font-weight: bold; color: #1976d2;">---</span> °C</p>
                                </div>
                                
                                <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem;">
                                    <b>Tepelná bilance:</b> <span id="hex-balance" style="font-weight: bold;">---</span>
                                </div>
                            </div>
                            
                            <div style="background-color: var(--bg-formula); padding: 1rem; border-radius: 0.4rem;">
                                <h4 style="color: var(--color-h); margin-bottom: 0.5rem;">Vzorce:</h4>
                                <p><b>Q_h:</b> $\dot{m}_h c_p (T_{h,in} - T_{h,out})$</p>
                                <p><b>Q_c:</b> $\dot{m}_c c_p (T_{c,out} - T_{c,in})$</p>
                                <p><b>Bilance:</b> $Q_h = Q_c$</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 10: Reaktor - základy -->
        <div class="slide compact">
            <h2>2.5 Reaktor - Stechiometrické bilance</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <p><b>Princip:</b> Chemická přeměna podle stechiometrické rovnice.</p>
                    
                    <p>Pro obecnou reakci: $aA + bB \rightarrow cC + dD$</p>

                    <div class="formula-box">
                        <h3>Stechiometrické koeficienty ($\nu_i$)</h3>
                        <ul class="list-disc pl-5 space-y-1">
                            <li><b>Reaktanty:</b> $\nu_A = -a$, $\nu_B = -b$ (záporné)</li>
                            <li><b>Produkty:</b> $\nu_C = +c$, $\nu_D = +d$ (kladné)</li>
                        </ul>
                    </div>

                    <div class="formula-box">
                        <h3>Molární bilance pro složku i</h3>
                        $$\dot{n}_{i,out} = \dot{n}_{i,in} + \nu_i \cdot \dot{\xi}$$
                        <p>$\dot{\xi}$ je <b>reakční rozsah</b> [mol/s]</p>
                    </div>

                    <div class="practice-box">
                        <h3>Příklad: $N_2 + 3H_2 \rightarrow 2NH_3$</h3>
                        <p>$\nu_{N_2} = -1$, $\nu_{H_2} = -3$, $\nu_{NH_3} = +2$</p>
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="reactorBalance" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 11a: Stupeň konverze - definice -->
        <div class="slide compact">
            <h2>2.5 Reaktor - Stupeň konverze: Definice</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="formula-box">
                        <h3>Definice stupně konverze ($X_A$)</h3>
                        <p>Podíl zreagované látky A z původního množství:</p>
                        $$X_A = \frac{\text{molů A zreagováno}}{\text{molů A na vstupu}} = \frac{\dot{n}_{A,in} - \dot{n}_{A,out}}{\dot{n}_{A,in}}$$
                    </div>

                    <div class="formula-box">
                        <h3>Souvislost s reakčním rozsahem</h3>
                        <p>Pro klíčový reaktant A (s koeficientem $\nu_A$):</p>
                        $$\dot{\xi} = \frac{X_A \cdot \dot{n}_{A,in}}{-\nu_A}$$
                        <p>Protože $\nu_A < 0$ pro reaktanty</p>
                    </div>

                    <div class="info-box">
                        <h3>⚠️ Pozor</h3>
                        <p>Stupeň konverze se definuje <b>pouze pro reaktanty</b>, ne produkty!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 11b: Stupeň konverze - aplikace -->
        <div class="slide compact">
            <h2>2.5 Reaktor - Stupeň konverze: Praktické použití</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <h3>Praktické hranice:</h3>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><b>$X_A = 0$:</b> Žádná reakce</li>
                        <li><b>$X_A = 1$:</b> Úplná konverze A</li>
                        <li><b>Typicky:</b> 0.7 - 0.95 v průmyslu</li>
                    </ul>

                    <div class="practice-box">
                        <h3>Výpočetní postup</h3>
                        <p>1. Zadej stupeň konverze $X_A$</p>
                        <p>2. Vypočti reakční rozsah $\dot{\xi}$</p>
                        <p>3. Použij molární bilance pro všechny složky</p>
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="conversionDiagram" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 12: Reaktor - tepelná bilance -->
        <div class="slide">
            <h2>2.5 Reaktor - Tepelná bilance fiktivními proudy</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <p style="text-align: center; margin-bottom: 1rem;">Složitý výpočet rozdělíme na <b>tři jednoduché kroky</b>:</p>
                    
                    <div class="three-column">
                        <div style="background-color: #e3f2fd; padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <h3 style="color: var(--color-h);">Krok 1</h3>
                            <p><b>Ohřev vstupů</b></p>
                            <p>$T_{in} \rightarrow T_{ref}$</p>
                            $$\Delta H_1 = \sum \dot{n}_{i,in} c_{p,i} (T_{ref} - T_{in})$$
                        </div>
                        
                        <div style="background-color: #fff3e0; padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <h3 style="color: var(--color-h);">Krok 2</h3>
                            <p><b>Reakce při T_ref</b></p>
                            $$\Delta H_2 = \dot{\xi} \cdot \Delta H_r^0$$
                            <p style="font-size: 0.9rem;">Exo: $\Delta H_r^0 < 0$<br>Endo: $\Delta H_r^0 > 0$</p>
                        </div>
                        
                        <div style="background-color: #e8f5e8; padding: 1rem; border-radius: 0.5rem; text-align: center;">
                            <h3 style="color: var(--color-h);">Krok 3</h3>
                            <p><b>Ohřev výstupů</b></p>
                            <p>$T_{ref} \rightarrow T_{out}$</p>
                            $$\Delta H_3 = \sum \dot{n}_{i,out} c_{p,i} (T_{out} - T_{ref})$$
                        </div>
                    </div>
                    
                    <div class="formula-box" style="margin-top: 1.5rem; text-align: center;">
                        <h3>Celková tepelná bilance</h3>
                        $$Q = \Delta H_{procesu} = \Delta H_1 + \Delta H_2 + \Delta H_3$$
                        <p>Pro <b>adiabatický reaktor</b>: $Q = 0$ (řešíme pro $T_{out}$)</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 12: Metodika řešení -->
        <div class="slide compact">
            <h2>4. Systematická metodika řešení</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <h3 style="margin-bottom: 1rem;">Postup řešení bilančních problémů</h3>
                    
                    <ol class="list-decimal pl-5 space-y-2">
                        <li><b>Přečti a pochop:</b> Co se v procesu děje?</li>
                        <li><b>Nakresli schéma:</b> Označ systém a proudy</li>
                        <li><b>Zvol základ:</b> Např. 100 kg vstupní suroviny</li>
                        <li><b>Napiš rovnice:</b> Sestav hmotnostní a tepelné bilance</li>
                        <li><b>Spočítej stupně volnosti:</b> Neznámé vs. rovnice</li>
                        <li><b>Vyřeš rovnice:</b> Postupně nebo jako soustavu</li>
                        <li><b>Zkontroluj výsledek:</b> Dává smysl? Jednotky?</li>
                    </ol>

                    <div class="formula-box">
                        <h3>Klíčová kontrola</h3>
                        <p><b>Stupně volnosti (DOF):</b></p>
                        $$\text{DOF} = \text{Neznámé} - \text{Nezávislé rovnice}$$
                        <p>Pro řešitelný problém: DOF = 0</p>
                    </div>

                    <div class="info-box">
                        <h3>💡 Zlaté pravidlo</h3>
                        <p><b>Vždy začni schématem!</b> Bez něj se v složitějších příkladech ztratíš.</p>
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="methodologyDiagram" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 13: Stupně volnosti -->
        <div class="slide compact">
            <h2>5. Stupně volnosti (DOF - Degrees of Freedom)</h2>
            <div class="slide-content layout-text-visual">
                <div class="content-text">
                    <div class="formula-box">
                        <h3>Základní definice</h3>
                        $$\text{DOF} = \text{Neznámé} - \text{Nezávislé rovnice}$$
                        <p><b>Pro řešitelný problém:</b> DOF = 0</p>
                    </div>

                    <h3>Interpretace výsledků:</h3>
                    <ul class="list-disc pl-5 space-y-2">
                        <li><b>DOF = 0:</b> Systém je <b>plně určen</b> - má jediné řešení</li>
                        <li><b>DOF > 0:</b> <b>Podspecifikovaný</b> systém - nekonečně mnoho řešení</li>
                        <li><b>DOF < 0:</b> <b>Přespecifikovaný</b> systém - žádné řešení (konfliktní rovnice)</li>
                    </ul>

                    <div class="info-box">
                        <h3>⚠️ Pozor na závislé rovnice!</h3>
                        <p>Například u mísícího systému (3 proudy, 2 složky):</p>
                        <p>• 3 celkové hmotnostní bilance → <b>pouze 2 nezávislé</b></p>
                        <p>• 6 složkových bilancí → <b>pouze 3 nezávislé</b></p>
                    </div>

                    <div class="practice-box">
                        <h3>Praktický postup</h3>
                        <p>1. Spočítej DOF <b>před</b> řešením</p>
                        <p>2. Pokud DOF ≠ 0 → definuj dodatečné podmínky</p>
                        <p>3. Ověř nezávislost rovnic</p>
                    </div>
                </div>
                <div class="content-visual">
                    <canvas id="dofDiagram" width="500" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Snímek 14: Časté chyby -->
        <div class="slide ultra-compact">
            <h2>6. Časté chyby a jejich prevence</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="two-column">
                        <div>
                            <h3 style="color: #d32f2f; margin-bottom: 1rem;">⚠️ Nejčastější chyby</h3>
                            
                            <div style="background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #d32f2f;">Jednotky</h4>
                                <p>Nejčastější zdroj chyb - vždy psát jednotky!</p>
                            </div>

                            <div style="background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #d32f2f;">Hmotnost vs. moly</h4>
                                <p>Pro reaktory: vždy molární bilance!</p>
                            </div>

                            <div style="background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #d32f2f;">Znaménka</h4>
                                <p>Q > 0 (ohřev), Q < 0 (chlazení)</p>
                            </div>

                            <div style="background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #d32f2f;">Špatné základy</h4>
                                <p>Volba nevhodného výpočetního základu</p>
                            </div>

                            <div style="background-color: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #d32f2f;">Nezávislé rovnice</h4>
                                <p>Počítání závislých rovnic jako nezávislých</p>
                            </div>
                        </div>

                        <div>
                            <h3 style="color: #2e7d32; margin-bottom: 1rem;">✓ Prevence a kontroly</h3>
                            
                            <div style="background-color: #e8f5e8; border-left: 5px solid #2e7d32; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #2e7d32;">Systematický přístup</h4>
                                <ul class="list-disc pl-4">
                                    <li>Vždy začni schématem</li>
                                    <li>Kontroluj jednotky po každém kroku</li>
                                    <li>Ověř celkovou bilanci</li>
                                </ul>
                            </div>

                            <div style="background-color: #e8f5e8; border-left: 5px solid #2e7d32; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #2e7d32;">Kontrolní otázky</h4>
                                <ul class="list-disc pl-4">
                                    <li>Fyzikální smysl výsledků?</li>
                                    <li>Sedí součty průtoků?</li>
                                    <li>Realistické koncentrace?</li>
                                </ul>
                            </div>

                            <div style="background-color: #fff3e0; border-left: 5px solid #ff9800; padding: 1rem; margin: 0.8rem 0; border-radius: 0.25rem;">
                                <h4 style="color: #ff9800;">Software pomoc</h4>
                                <ul class="list-disc pl-4">
                                    <li><b>Excel:</b> Lineární soustavy</li>
                                    <li><b>Python:</b> NumPy, SciPy</li>
                                    <li><b>DWSIM:</b> Simulace</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 14: Příklad 1 - Mísič -->
        <div class="slide compact">
            <h2>Příklad 1: Mísič - Mísení H₂SO₄</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="example-tabs">
                        <button class="example-tab active" onclick="switchTab('mixer', 'zadani')">Zadání</button>
                        <button class="example-tab" onclick="switchTab('mixer', 'postup')">Postup</button>
                        <button class="example-tab" onclick="switchTab('mixer', 'reseni')">Řešení</button>
                        <button class="example-tab" onclick="switchTab('mixer', 'vysledky')">Výsledky</button>
                        <button class="example-tab" onclick="switchTab('mixer', 'chyby')">Časté chyby</button>
                    </div>
                    
                    <div class="example-content active" id="mixer-zadani">
                        <div class="example-grid">
                            <div class="process-schema">
                                <canvas id="mixerExampleDiagram" width="400" height="300"></canvas>
                            </div>
                            <div>
                                <p><b>V chemickém provozu</b> připravujeme roztok H₂SO₄ smícháním:</p>
                                <ul>
                                    <li><b>Proud 1:</b> 200 kg/h roztoku s 20 % hm. H₂SO₄</li>
                                    <li><b>Proud 2:</b> 50 kg/h koncentrované kyseliny s 98 % hm. H₂SO₄</li>
                                </ul>
                                <p><b>Vypočítejte:</b> Hmotnostní průtok a koncentraci výstupního proudu.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="mixer-postup">
                        <h3>Postup řešení</h3>
                        <div class="two-column">
                            <div>
                                <h4>1. Nakreslit schéma</h4>
                                <p>Označte všechny proudy a jejich vlastnosti.</p>
                                
                                <h4>2. Celková hmotnostní bilance</h4>
                                <p><b>Princip:</b> Vstup = Výstup</p>
                                $$\dot{m}_1 + \dot{m}_2 = \dot{m}_3$$
                                
                                <h4>3. Složková bilance H₂SO₄</h4>
                                <p><b>Princip:</b> Hmotnost H₂SO₄ na vstupu = na výstupu</p>
                                $$\dot{m}_1 \cdot w_1 + \dot{m}_2 \cdot w_2 = \dot{m}_3 \cdot w_3$$
                            </div>
                            <div>
                                <div class="example-tip">
                                    <b>💡 Tip:</b> Vždy převeďte procenta na zlomky (20% = 0,20)
                                </div>
                                
                                <div class="example-warning">
                                    <b>⚠️ Pozor:</b> Kontrolujte jednotky - vše musí být kg/h nebo g/s
                                </div>
                                
                                <h4>4. Kontrola výsledku</h4>
                                <ul>
                                    <li>Výsledná koncentrace musí být mezi vstupními (20% - 98%)</li>
                                    <li>Celková hmotnostní bilance musí sedět</li>
                                    <li>Hmotnostní zlomky ≤ 1</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="mixer-reseni">
                        <h3>Řešení krok za krokem</h3>
                        <div class="two-column">
                            <div>
                                <h4>Dané hodnoty:</h4>
                                <ul>
                                    <li>$\dot{m}_1 = 200$ kg/h, $w_1 = 0,20$</li>
                                    <li>$\dot{m}_2 = 50$ kg/h, $w_2 = 0,98$</li>
                                    <li>$\dot{m}_3 = ?$, $w_3 = ?$</li>
                                </ul>
                                
                                <h4>Celková bilance:</h4>
                                $$\dot{m}_3 = \dot{m}_1 + \dot{m}_2$$
                                $$\dot{m}_3 = 200 + 50 = 250 \text{ kg/h}$$
                                
                                <h4>Složková bilance:</h4>
                                $$200 \cdot 0{,}20 + 50 \cdot 0{,}98 = 250 \cdot w_3$$
                                $$40 + 49 = 250 \cdot w_3$$
                                $$w_3 = \frac{89}{250} = 0{,}356$$
                            </div>
                            <div>
                                <div style="background: #e8f5e8; padding: 1rem; border-radius: 0.5rem;">
                                    <h4 style="color: #2e7d32;">✓ Výsledek:</h4>
                                    <p><b>Výstupní průtok:</b> 250 kg/h</p>
                                    <p><b>Koncentrace H₂SO₄:</b> 35,6 % hm.</p>
                                </div>
                                
                                <h4>Kontrola:</h4>
                                <ul>
                                    <li>35,6% je mezi 20% a 98% ✓</li>
                                    <li>Hmotnostní bilance: 250 = 200 + 50 ✓</li>
                                    <li>H₂SO₄ bilance: 89 = 40 + 49 ✓</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="mixer-vysledky">
                        <h3>Interaktivní výpočet</h3>
                        <div class="two-column">
                            <div>
                                <div class="example-calc">
                                    <h4>Zadejte hodnoty</h4>
                                    <div class="calc-inputs">
                                        <div class="calc-input-row">
                                            <label>Proud 1 - průtok:</label>
                                            <input type="number" id="mixer2-m1" value="200" class="calc-input">
                                            <span>kg/h</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Proud 1 - koncentrace:</label>
                                            <input type="number" id="mixer2-w1" value="20" class="calc-input">
                                            <span>%</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Proud 2 - průtok:</label>
                                            <input type="number" id="mixer2-m2" value="50" class="calc-input">
                                            <span>kg/h</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Proud 2 - koncentrace:</label>
                                            <input type="number" id="mixer2-w2" value="98" class="calc-input">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <button class="calc-button" onclick="solveMixer2()">Vypočítej</button>
                                </div>
                            </div>
                            <div>
                                <div class="calc-result" id="mixer2-result" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                    <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Výsledek míchání H₂SO₄</h4>
                                    
                                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                        <p><b>Celková bilance:</b> <span id="mixer2-mass-balance" style="font-weight: bold; color: #003f88;">---</span></p>
                                        <p><b>Složková bilance H₂SO₄:</b></p>
                                        <p><span id="mixer2-component-balance" style="font-weight: bold;">---</span></p>
                                        <p><span id="mixer2-component-kg" style="font-weight: bold;">---</span></p>
                                    </div>
                                    
                                    <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem; margin-bottom: 0.8rem;">
                                        <b>Koncentrace výstupního proudu:</b> <span id="mixer2-final-conc" style="font-weight: bold; color: #d32f2f;">---</span>
                                    </div>
                                    
                                    <div style="background: #fff3e0; padding: 0.8rem; border-radius: 0.5rem;">
                                        <b>Kontrola:</b> <span id="mixer2-checks" style="font-weight: bold;">---</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="mixer-chyby">
                        <h3>Časté chyby a jejich prevence</h3>
                        <div class="two-column">
                            <div>
                                <div style="background: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.5rem 0;">
                                    <h4 style="color: #d32f2f;">❌ Chyba: Procenta místo zlomků</h4>
                                    <p><b>Špatně:</b> 200 × 20 + 50 × 98 = 250 × w₃</p>
                                    <p><b>Správně:</b> 200 × 0,20 + 50 × 0,98 = 250 × w₃</p>
                                </div>
                                
                                <div style="background: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.5rem 0;">
                                    <h4 style="color: #d32f2f;">❌ Chyba: Nekonzistentní jednotky</h4>
                                    <p>Všechny průtoky musí být ve stejných jednotkách!</p>
                                </div>
                            </div>
                            <div>
                                <div style="background: #e8f5e8; border-left: 5px solid #4caf50; padding: 1rem; margin: 0.5rem 0;">
                                    <h4 style="color: #2e7d32;">✓ Správná praxe</h4>
                                    <ul>
                                        <li>Vždy převádět % na desetinné zlomky</li>
                                        <li>Kontrolovat jednotky v každém kroku</li>
                                        <li>Ověřit fyzikální smysl výsledku</li>
                                    </ul>
                                </div>
                                
                                <div class="example-tip">
                                    <b>💡 Mnemotechnická pomůcka:</b><br>
                                    "Procenta na zlomky, jednotky stejné, výsledek mezi krajními"
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 15: Příklad 2 - Dělič proudu -->
        <div class="slide compact">
            <h2>Příklad 2: Dělič proudu - Rozdělení toluenu</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="example-tabs">
                        <button class="example-tab active" onclick="switchTab('splitter', 'zadani')">Zadání</button>
                        <button class="example-tab" onclick="switchTab('splitter', 'postup')">Postup</button>
                        <button class="example-tab" onclick="switchTab('splitter', 'reseni')">Řešení</button>
                        <button class="example-tab" onclick="switchTab('splitter', 'vysledky')">Výsledky</button>
                        <button class="example-tab" onclick="switchTab('splitter', 'chyby')">Časté chyby</button>
                    </div>
                    
                    <div class="example-content active" id="splitter-zadani">
                        <div class="example-grid">
                            <div class="process-schema">
                                <canvas id="splitterExampleDiagram" width="400" height="300"></canvas>
                            </div>
                            <div>
                                <p><b>Uhlovodíková směs</b> vstupuje do děliče proudu:</p>
                                <ul>
                                    <li><b>Celkový průtok:</b> 500 kg/h</li>
                                    <li><b>Složení:</b> 60% toluen, 40% benzen</li>
                                    <li><b>Rozdělení:</b> 70% do procesu, 30% do zásobníku</li>
                                </ul>
                                <p><b>Vypočítejte:</b> Průtoky a složení obou výstupních proudů.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="splitter-postup">
                        <h3>Postup řešení</h3>
                        <p><b>Klíčový princip:</b> Dělič proudu nemění složení - pouze dělí hmotnostní tok.</p>
                        
                        <div class="formula-box">
                            <h4>Platné vztahy pro dělič:</h4>
                            <p>1. Celková hmotnostní bilance: $\dot{m}_1 = \dot{m}_2 + \dot{m}_3$</p>
                            <p>2. Stejné složení: $w_{A,1} = w_{A,2} = w_{A,3}$</p>
                            <p>3. Stejná teplota: $T_1 = T_2 = T_3$</p>
                        </div>
                        
                        <div class="example-tip">
                            <b>💡 Tip:</b> U děliče proudu se řeší pouze rozdělení celkového průtoku. Složkové bilance jsou triviální.
                        </div>
                    </div>
                    
                    <div class="example-content" id="splitter-reseni">
                        <h3>Řešení</h3>
                        <div class="two-column">
                            <div>
                                <h4>Dané:</h4>
                                <ul>
                                    <li>$\dot{m}_1 = 500$ kg/h</li>
                                    <li>70% do proudu 2, 30% do proudu 3</li>
                                    <li>Složení: 60% toluen, 40% benzen</li>
                                </ul>
                                
                                <h4>Výpočet průtoků:</h4>
                                $$\dot{m}_2 = 0{,}70 \times 500 = 350 \text{ kg/h}$$
                                $$\dot{m}_3 = 0{,}30 \times 500 = 150 \text{ kg/h}$$
                                
                                <p>Kontrola: $350 + 150 = 500$ kg/h ✓</p>
                            </div>
                            <div>
                                <div style="background: #e8f5e8; padding: 1rem; border-radius: 0.5rem;">
                                    <h4 style="color: #2e7d32;">✓ Výsledek:</h4>
                                    <p><b>Proud 2 (proces):</b></p>
                                    <ul>
                                        <li>Průtok: 350 kg/h</li>
                                        <li>60% toluen, 40% benzen</li>
                                    </ul>
                                    <p><b>Proud 3 (zásobník):</b></p>
                                    <ul>
                                        <li>Průtok: 150 kg/h</li>
                                        <li>60% toluen, 40% benzen</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="splitter-vysledky">
                        <h3>Interaktivní výpočet</h3>
                        <div class="two-column">
                            <div>
                                <div class="example-calc">
                                    <h4>Zadejte hodnoty</h4>
                                    <div class="calc-inputs">
                                        <div class="calc-input-row">
                                            <label>Vstupní průtok:</label>
                                            <input type="number" id="splitter-m1" value="500" class="calc-input">
                                            <span>kg/h</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Podíl do procesu:</label>
                                            <input type="number" id="splitter-split" value="70" class="calc-input">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <button class="calc-button" onclick="solveSplitter()">Vypočítej</button>
                                </div>
                            </div>
                            <div>
                                <div class="calc-result" id="splitter-result" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                    <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Výsledek dělení toluenu</h4>
                                    
                                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                        <p><b>Proud 2:</b> <span id="splitter-m2" style="font-weight: bold; color: #1976d2;">---</span> kg/h (<span id="splitter-perc2" style="font-weight: bold;">---</span>%)</p>
                                        <p><b>Proud 3:</b> <span id="splitter-m3" style="font-weight: bold; color: #d32f2f;">---</span> kg/h (<span id="splitter-perc3" style="font-weight: bold;">---</span>%)</p>
                                    </div>
                                    
                                    <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem; margin-bottom: 0.8rem;">
                                        <b>Kontrola:</b> <span id="splitter-check" style="font-weight: bold;">---</span>
                                    </div>
                                    
                                    <div style="background: #fff3e0; padding: 0.8rem; border-radius: 0.5rem;">
                                        <b>Poznámka:</b> <span id="splitter-notes" style="font-weight: bold;">---</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="splitter-chyby">
                        <h3>Časté chyby</h3>
                        <div style="background: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.5rem 0;">
                            <h4 style="color: #d32f2f;">❌ Zbytečná složková bilance</h4>
                            <p>Studenti často sestavují složitou rovnici:</p>
                            <p>$\dot{m}_1 \cdot w_{toluen,1} = \dot{m}_2 \cdot w_{toluen,2} + \dot{m}_3 \cdot w_{toluen,3}$</p>
                            <p><b>Není potřeba!</b> U děliče je $w_{toluen,1} = w_{toluen,2} = w_{toluen,3}$</p>
                        </div>
                        
                        <div style="background: #e8f5e8; border-left: 5px solid #4caf50; padding: 1rem; margin: 0.5rem 0;">
                            <h4 style="color: #2e7d32;">✓ Správný přístup</h4>
                            <p>U děliče proudu stačí:</p>
                            <ol>
                                <li>Spočítat dělení celkového průtoku</li>
                                <li>Převzít stejné složení pro všechny proudy</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 16: Příklad 3 - Reaktor -->
        <div class="slide compact">
            <h2>Příklad 3: Reaktor - Syntéza amoniaku</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="example-tabs">
                        <button class="example-tab active" onclick="switchTab('reactor', 'zadani')">Zadání</button>
                        <button class="example-tab" onclick="switchTab('reactor', 'postup')">Postup</button>
                        <button class="example-tab" onclick="switchTab('reactor', 'reseni')">Řešení</button>
                        <button class="example-tab" onclick="switchTab('reactor', 'vysledky')">Výsledky</button>
                        <button class="example-tab" onclick="switchTab('reactor', 'chyby')">Časté chyby</button>
                    </div>
                    
                    <div class="example-content active" id="reactor-zadani">
                        <div class="example-grid">
                            <div class="process-schema">
                                <canvas id="reactorExampleDiagram" width="400" height="300"></canvas>
                            </div>
                            <div>
                                <p><b>Do reaktoru</b> vstupuje stechiometrická směs N₂ a H₂:</p>
                                <ul>
                                    <li><b>Celkový molární průtok:</b> 100 mol/s</li>
                                    <li><b>Reakce:</b> N₂ + 3H₂ → 2NH₃</li>
                                    <li><b>Konverze dusíku:</b> 25%</li>
                                </ul>
                                <p><b>Vypočítejte:</b> Molární průtoky všech složek na výstupu.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="reactor-postup">
                        <h3>Postup řešení</h3>
                        <div class="two-column">
                            <div>
                                <h4>1. Stechiometrie a vstupní proudy</h4>
                                <p><b>N₂ + 3H₂ → 2NH₃</b></p>
                                <p>Poměr 1:3, celkem 4 "díly"</p>
                                <ul>
                                    <li>N₂: 1/4 × 100 = 25 mol/s</li>
                                    <li>H₂: 3/4 × 100 = 75 mol/s</li>
                                    <li>NH₃: 0 mol/s (čistý vstup)</li>
                                </ul>
                                
                                <h4>2. Konverze</h4>
                                <p><b>Konverze X = 25%</b> vztažená k N₂</p>
                                <p>Zreagovaný N₂ = 25 × 0,25 = 6,25 mol/s</p>
                            </div>
                            <div>
                                <div class="example-tip">
                                    <b>💡 Tip:</b> U reaktorů pracujeme vždy s moly, ne s hmotností!
                                </div>
                                
                                <div class="example-warning">
                                    <b>⚠️ Pozor:</b> Stechiometrické poměry jsou molární (1:3:2)
                                </div>
                                
                                <h4>3. Molární bilance</h4>
                                <p><b>Obecná rovnice:</b></p>
                                <p>VÝSTUP = VSTUP - ZREAGOVALO + VZNIKLO</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="reactor-reseni">
                        <h3>Řešení krok za krokem</h3>
                        <div class="two-column">
                            <div>
                                <h4>Vstupní proudy:</h4>
                                <ul>
                                    <li>n(N₂,in) = 25 mol/s</li>
                                    <li>n(H₂,in) = 75 mol/s</li>
                                    <li>n(NH₃,in) = 0 mol/s</li>
                                </ul>
                                
                                <h4>Zreagované množství:</h4>
                                <p>n(N₂,reag) = 25 × 0,25 = <b>6,25 mol/s</b></p>
                                <p>n(H₂,reag) = 3 × 6,25 = <b>18,75 mol/s</b></p>
                                <p>n(NH₃,vznik) = 2 × 6,25 = <b>12,5 mol/s</b></p>
                                
                                <h4>Výstupní molární bilance:</h4>
                                <ul>
                                    <li>N₂: 25 - 6,25 = <b>18,75 mol/s</b></li>
                                    <li>H₂: 75 - 18,75 = <b>56,25 mol/s</b></li>
                                    <li>NH₃: 0 + 12,5 = <b>12,5 mol/s</b></li>
                                </ul>
                            </div>
                            <div>
                                <div style="background: #e8f5e8; padding: 1rem; border-radius: 0.5rem;">
                                    <h4 style="color: #2e7d32;">✓ Výsledek:</h4>
                                    <p><b>Výstupní molární toky:</b></p>
                                    <ul>
                                        <li><b>N₂:</b> 18,75 mol/s</li>
                                        <li><b>H₂:</b> 56,25 mol/s</li>
                                        <li><b>NH₃:</b> 12,5 mol/s</li>
                                    </ul>
                                    <p><b>Celkem:</b> 87,5 mol/s</p>
                                </div>
                                
                                <h4>Kontrola:</h4>
                                <ul>
                                    <li>Stechiometrie: N₂:H₂:NH₃ = 6,25:18,75:12,5 = 1:3:2 ✓</li>
                                    <li>Konverze: 6,25/25 = 0,25 = 25% ✓</li>
                                    <li>Celkové moly se změnily (100→87,5) ✓</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="reactor-vysledky">
                        <h3>Interaktivní výpočet</h3>
                        <div class="two-column">
                            <div>
                                <div class="example-calc">
                                    <h4>Zadejte hodnoty</h4>
                                    <div class="calc-inputs">
                                        <div class="calc-input-row">
                                            <label>H₂ průtok:</label>
                                            <input type="number" id="reactorH2Input" value="100" class="calc-input">
                                            <span>mol/h</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Konverze N₂:</label>
                                            <input type="number" id="reactorConversionInput" value="80" class="calc-input">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <button class="calc-button" onclick="solveReactor()">Vypočítej</button>
                                </div>
                            </div>
                            <div>
                                <div class="calc-result" id="reactor-result" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                    <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Řešení syntézy amoniaku</h4>
                                    
                                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                        <p><strong>Vstup:</strong></p>
                                        <p>• N₂: <span id="react-n2-in" style="font-weight: bold; color: #1976d2;">---</span> mol/h</p>
                                        <p>• H₂: <span id="react-h2-in" style="font-weight: bold; color: #1976d2;">---</span> mol/h</p>
                                        <p><strong>Výstup:</strong></p>
                                        <p>• N₂: <span id="react-n2-out" style="font-weight: bold; color: #1976d2;">---</span> mol/h</p>
                                        <p>• H₂: <span id="react-h2-out" style="font-weight: bold; color: #1976d2;">---</span> mol/h</p>
                                        <p>• NH₃: <span id="react-nh3-out" style="font-weight: bold; color: #d32f2f;">---</span> mol/h</p>
                                    </div>
                                    
                                    <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem; margin-bottom: 0.8rem;">
                                        <b>Kontrola bilance:</b> <span id="react-check" style="font-weight: bold;">---</span>
                                    </div>
                                    
                                    <div style="background: #fff3e0; padding: 0.8rem; border-radius: 0.5rem;">
                                        <b>Konverze:</b> <span id="react-conv" style="font-weight: bold; color: #d32f2f;">---</span><br>
                                        <b>Reakční extent:</b> <span id="react-extent" style="font-weight: bold;">---</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="reactor-chyby">
                        <h3>Časté chyby u reaktorů</h3>
                        <div class="two-column">
                            <div>
                                <div style="background: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.5rem 0;">
                                    <h4 style="color: #d32f2f;">❌ Kritická chyba: Hmotnost místo molů</h4>
                                    <p>Stechiometrické výpočty <b>MUSÍ</b> být v molech!</p>
                                    <p><b>Špatně:</b> Pracovat s kg a poměry 1:3:2</p>
                                    <p><b>Správně:</b> Převést na moly, pak stechiometrie</p>
                                </div>
                                
                                <div style="background: #ffebee; border-left: 5px solid #d32f2f; padding: 1rem; margin: 0.5rem 0;">
                                    <h4 style="color: #d32f2f;">❌ Chyba: Celkový počet molů</h4>
                                    <p>Na rozdíl od hmotnosti se celkový počet molů při reakci mění!</p>
                                    <p>Vstup: 100 mol/s → Výstup: 87,5 mol/s</p>
                                </div>
                            </div>
                            <div>
                                <div style="background: #e8f5e8; border-left: 5px solid #4caf50; padding: 1rem; margin: 0.5rem 0;">
                                    <h4 style="color: #2e7d32;">✓ Správný postup</h4>
                                    <ol>
                                        <li>Převést vše na molární toky</li>
                                        <li>Určit stechiometrické poměry</li>
                                        <li>Spočítat zreagované množství z konverze</li>
                                        <li>Aplikovat molární bilanci pro každou složku</li>
                                        <li>Zkontrolovat stechiometrii</li>
                                    </ol>
                                </div>
                                
                                <div class="example-tip">
                                    <b>💡 Mnemotechnická pomůcka:</b><br>
                                    "Reaktor = moly, stechiometrie, bilance po složkách"
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 17: Příklad 4: Prostý dělič -->
        <div class="slide">
            <h2>Příklad 4: Separátor složek - Rozdělení směsi</h2>
            <div class="slide-content layout-full">
                <div class="content-full">
                    <div class="example-tabs">
                        <button class="example-tab active" onclick="switchTab('simple-divider', 'zadani')">Zadání</button>
                        <button class="example-tab" onclick="switchTab('simple-divider', 'postup')">Postup</button>
                        <button class="example-tab" onclick="switchTab('simple-divider', 'reseni')">Řešení</button>
                        <button class="example-tab" onclick="switchTab('simple-divider', 'vysledky')">Výsledky</button>
                        <button class="example-tab" onclick="switchTab('simple-divider', 'chyby')">Časté chyby</button>
                    </div>
                    
                    <div class="example-content active" id="simple-divider-zadani">
                        <div class="example-grid">
                            <div class="process-schema">
                                <canvas id="simpleDividerExampleDiagram" width="400" height="300"></canvas>
                            </div>
                            <div>
                                <p><b>V separačním procesu</b> rozdělujeme směs podle složek:</p>
                                <ul>
                                    <li><b>Vstupní proud:</b> 1000 kg/h směsi (40% etanol, 60% voda)</li>
                                    <li><b>Teplota:</b> 80°C</li>
                                    <li><b>Separace etanolu:</b> 80% etanolu jde do proudu 1, 20% do proudu 2</li>
                                    <li><b>Separace vody:</b> 30% vody jde do proudu 1, 70% do proudu 2</li>
                                </ul>
                                <p><b>Vypočítejte:</b> Hmotnostní průtoky a složení obou výstupních proudů.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="simple-divider-postup">
                        <h3>Postup řešení</h3>
                        <div class="two-column">
                            <div>
                                <p><b>1. Hmotnostní bilance vstupních složek:</b></p>
                                <p>$$\dot{m}_{etanol,vstup} = 1000 \times 0.40 = 400 \text{ kg/h}$$</p>
                                <p>$$\dot{m}_{voda,vstup} = 1000 \times 0.60 = 600 \text{ kg/h}$$</p>
                                
                                <p><b>2. Separace etanolu podle poměru:</b></p>
                                <p>$$\dot{m}_{etanol,proud1} = 400 \times 0.80 = 320 \text{ kg/h}$$</p>
                                <p>$$\dot{m}_{etanol,proud2} = 400 \times 0.20 = 80 \text{ kg/h}$$</p>
                            </div>
                            <div>
                                <p><b>3. Separace vody podle poměru:</b></p>
                                <p>$$\dot{m}_{voda,proud1} = 600 \times 0.30 = 180 \text{ kg/h}$$</p>
                                <p>$$\dot{m}_{voda,proud2} = 600 \times 0.70 = 420 \text{ kg/h}$$</p>
                                
                                <p><b>4. Celkové průtoky a složení:</b></p>
                                <p>$$\dot{m}_{proud1} = 320 + 180 = 500 \text{ kg/h}$$</p>
                                <p>$$\dot{m}_{proud2} = 80 + 420 = 500 \text{ kg/h}$$</p>
                                <p><b>Teplota se nemění:</b> všechny proudy 80°C</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="simple-divider-reseni">
                        <h3>Detailní řešení</h3>
                        <div class="two-column">
                            <div>
                                <div class="formula-box">
                                    <h3>Hmotnostní bilance</h3>
                                    <p>$$\dot{m}_{vstup} = \dot{m}_{proud1} + \dot{m}_{proud2}$$</p>
                                    <p>$$1000 = 500 + 500 \text{ kg/h}$$</p>
                                </div>
                                
                                <div class="practice-box">
                                    <h3>Složková bilance etanolu</h3>
                                    <p>$$\dot{m}_{etanol,vstup} = \dot{m}_{etanol,proud1} + \dot{m}_{etanol,proud2}$$</p>
                                    <p>$$400 = 320 + 80 \text{ kg/h}$$</p>
                                    <p><b>Separační koeficient etanolu:</b> α = 0.80</p>
                                </div>
                            </div>
                            <div>
                                <div class="formula-box">
                                    <h3>Složení výstupních proudů</h3>
                                    <p><b>Proud 1 (320 kg etanolu + 180 kg vody):</b></p>
                                    <p>• Etanol: 320/500 = 64.0% hm.</p>
                                    <p>• Voda: 180/500 = 36.0% hm.</p>
                                    <p><b>Proud 2 (80 kg etanolu + 420 kg vody):</b></p>
                                    <p>• Etanol: 80/500 = 16.0% hm.</p>
                                    <p>• Voda: 420/500 = 84.0% hm.</p>
                                </div>
                                
                                <div class="info-box">
                                    <h3>Klíčová vlastnost separátoru</h3>
                                    <p><b>RŮZNÁ složení:</b> 64% vs 16% etanolu</p>
                                    <p><b>Teplota zachována:</b> všechny proudy 80°C</p>
                                    <p><b>Bilance sedí:</b> 500 + 500 = 1000 kg/h</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="simple-divider-vysledky">
                        <h3>Interaktivní výpočet</h3>
                        <div class="two-column">
                            <div>
                                <div class="example-calc">
                                    <h4>Zadejte hodnoty</h4>
                                    <div class="calc-inputs">
                                        <div class="calc-input-row">
                                            <label>Vstupní průtok:</label>
                                            <input type="number" id="simple-divider-m1" value="1000" class="calc-input">
                                            <span>kg/h</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Koncentrace etanolu:</label>
                                            <input type="number" id="simple-divider-conc" value="40" class="calc-input">
                                            <span>%</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Separace etanolu do proudu 1:</label>
                                            <input type="number" id="simple-divider-eth-sep" value="80" class="calc-input">
                                            <span>%</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Separace vody do proudu 1:</label>
                                            <input type="number" id="simple-divider-water-sep" value="30" class="calc-input">
                                            <span>%</span>
                                        </div>
                                        <div class="calc-input-row">
                                            <label>Teplota vstupu:</label>
                                            <input type="number" id="simple-divider-temp" value="80" class="calc-input">
                                            <span>°C</span>
                                        </div>
                                    </div>
                                    <button class="calc-button" onclick="solveSimpleDivider()">Vypočítej</button>
                                </div>
                            </div>
                            <div>
                                <div class="calc-result" id="simple-divider-result" style="visibility: visible; opacity: 1; background: #f0f8ff; border: 2px solid #0056b3; border-radius: 0.8rem; padding: 1.5rem; display: block;">
                                    <h4 style="color: #003f88; margin-bottom: 1rem; border-bottom: 2px solid #0056b3; padding-bottom: 0.5rem;">🎯 Výsledek separace ethanol-voda</h4>
                                    
                                    <div style="background: white; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;">
                                        <p><b>Proud 2 (Koncentrovaný):</b> <span id="sep-m2" style="font-weight: bold; color: #003f88;">---</span> kg/h</p>
                                        <p>• Ethanol: <span id="sep-eth2" style="font-weight: bold; color: #d32f2f;">---</span>% (<span id="sep-eth2-kg" style="font-weight: bold;">---</span> kg/h)</p>
                                        <p>• Voda: <span id="sep-water2" style="font-weight: bold; color: #1976d2;">---</span>% (<span id="sep-water2-kg" style="font-weight: bold;">---</span> kg/h)</p>
                                        
                                        <p style="margin-top: 1rem;"><b>Proud 3 (Zředěný):</b> <span id="sep-m3" style="font-weight: bold; color: #003f88;">---</span> kg/h</p>
                                        <p>• Ethanol: <span id="sep-eth3" style="font-weight: bold; color: #d32f2f;">---</span>% (<span id="sep-eth3-kg" style="font-weight: bold;">---</span> kg/h)</p>
                                        <p>• Voda: <span id="sep-water3" style="font-weight: bold; color: #1976d2;">---</span>% (<span id="sep-water3-kg" style="font-weight: bold;">---</span> kg/h)</p>
                                    </div>
                                    
                                    <div style="background: #e8f5e8; padding: 0.8rem; border-radius: 0.5rem;">
                                        <b>Kontrola bilance:</b> <span id="sep-check" style="font-weight: bold;">---</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="example-content" id="simple-divider-chyby">
                        <h3>Časté chyby a jejich prevence</h3>
                        <div class="two-column">
                            <div>
                                <div class="practice-box">
                                    <h3>❌ Chyba 1: Stejné složení</h3>
                                    <p><b>Problém:</b> Studenti počítají se stejným složením u výstupů</p>
                                    <p><b>Řešení:</b> U separátoru složek se složení <b>vždy mění</b></p>
                                </div>
                                
                                <div class="practice-box">
                                    <h3>❌ Chyba 2: Separační koeficienty</h3>
                                    <p><b>Problém:</b> Nerozlišení mezi separací složek A a B</p>
                                    <p><b>Řešení:</b> Každá složka má svůj separační poměr</p>
                                </div>
                            </div>
                            <div>
                                <div class="practice-box">
                                    <h3>❌ Chyba 3: Záměna s děličem proudu</h3>
                                    <p><b>Problém:</b> Záměna separátoru složek za prostý dělič</p>
                                    <p><b>Řešení:</b> Separátor = různá složení, dělič = stejná složení</p>
                                </div>
                                
                                <div class="info-box">
                                    <h3>✅ Tip pro kontrolu</h3>
                                    <p>Celková bilance: 500 + 500 = 1000 kg/h ✓</p>
                                    <p>Složková bilance etanolu: 320 + 80 = 400 kg/h ✓</p>
                                    <p>Výstupní složení MUSÍ být různé!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Snímek 18: Závěrečný -->
        <div class="slide final-slide">
            <h1>Děkuji za pozornost</h1>
            <h2>Prostor pro vaše dotazy</h2>
        </div>

        <!-- Snímek 15: Cheat Sheet -->
        <div class="slide cheat-sheet">
            <h2>Souhrn klíčových informací</h2>
            
            <div style="columns: 2; column-gap: 2rem;">
                <h3>Univerzální bilanční rovnice</h3>
                <div style="background: #eef2f7; padding: 0.8rem; border-radius: 0.25rem; margin: 0.4rem 0;">
                    <b>Obecná:</b> VSTUP - VÝSTUP + ZDROJ - SPOTŘEBA = AKUMULACE<br>
                    <b>Ustálený stav:</b> VSTUP + ZDROJ = VÝSTUP + SPOTŘEBA
                </div>

                <h3>Procesní aparáty</h3>
                <ul>
                    <li><b>Mísič:</b> $\dot{m}_1 + \dot{m}_2 = \dot{m}_3$, složení se mísí</li>
                    <li><b>Dělič proudu:</b> $\dot{m}_1 = \dot{m}_2 + \dot{m}_3$, stejné složení</li>
                    <li><b>Dělič složek:</b> Rozdílné složení, +energie</li>
                    <li><b>Výměník:</b> $Q_h = Q_c$, oddělené proudy</li>
                    <li><b>Reaktor:</b> Stechiometrie, ±teplo reakce</li>
                </ul>

                <h3>Reaktor - klíčové rovnice</h3>
                <div style="background: #eef2f7; padding: 0.8rem; border-radius: 0.25rem; margin: 0.4rem 0;">
                    <b>Molární bilance:</b> $\dot{n}_{i,out} = \dot{n}_{i,in} + \nu_i \cdot \dot{\xi}$<br>
                    <b>Tepelná bilance:</b> $Q = \Delta H_1 + \Delta H_2 + \Delta H_3$
                </div>

                <h3>Metodika (7 kroků)</h3>
                <ol>
                    <li>Pochopit zadání</li>
                    <li><b>Nakreslit schéma</b></li>
                    <li>Zvolit základ</li>
                    <li>Napsat rovnice</li>
                    <li>Stupně volnosti</li>
                    <li>Vyřešit</li>
                    <li>Zkontrolovat</li>
                </ol>

                <h3>Časté chyby</h3>
                <ul>
                    <li><b>Jednotky</b> - vždy kontrolovat</li>
                    <li><b>Hmotnost vs moly</b> - reaktory = moly!</li>
                    <li><b>Znaménka</b> - Q, ΔHᵣ směry</li>
                    <li><b>Hranice systému</b> - správné definování</li>
                </ul>

                <h3>Kontroly</h3>
                <ul>
                    <li><b>Celková hmotnostní bilance</b> (vždy platí)</li>
                    <li><b>Fyzikální smysl</b> výsledků</li>
                    <li><b>Jednotky</b> ve všech krocích</li>
                    <li><b>Stupně volnosti</b> ≤ 0</li>
                </ul>

                <h3>Software nástroje</h3>
                <ul>
                    <li><b>Excel:</b> Soustavy rovnic, parametrické studie</li>
                    <li><b>Python:</b> NumPy.linalg.solve, SciPy.optimize</li>
                    <li><b>DWSIM:</b> Procesní simulace (zdarma)</li>
                    <li><b>Aspen Plus:</b> Průmyslový standard</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Navigační prvky -->
    <div id="prev-slide" class="nav-arrow">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
    </div>
    <div id="next-slide" class="nav-arrow">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
    </div>
    
    <div id="fullscreen-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3m-18 0h3a2 2 0 0 1 2 2v3"></path>
        </svg>
    </div>
    
    <div id="progress-bar"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            console.log('🟢 PRESENTATION LOADED');
            
            // Renderování matematiky pomocí KaTeX
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false},
                ]
            });

            // Logika prezentace
            const slides = document.querySelectorAll('.slide');
            const prevButton = document.getElementById('prev-slide');
            const nextButton = document.getElementById('next-slide');
            const progressBar = document.getElementById('progress-bar');
            const fullscreenButton = document.getElementById('fullscreen-btn');
            
            let currentSlide = 0;
            const totalSlides = slides.length;
            
            console.log('📊 Found slides:', totalSlides);
            
            function showSlide(index) {
                console.log('🎯 ShowSlide called with index:', index);
                
                if (index >= totalSlides) index = totalSlides - 1;
                if (index < 0) index = 0;

                slides.forEach((slide, i) => {
                    slide.classList.toggle('active', i === index);
                });
                
                currentSlide = index;
                updateControls();
                
                console.log('✅ Slide updated to:', currentSlide + 1);
            }

            function updateControls() {
                // Progress bar
                const progress = (currentSlide) / (totalSlides - 1);
                progressBar.style.width = `${progress * 100}%`;

                // Navigation arrows
                prevButton.style.display = currentSlide === 0 ? 'none' : 'flex';
                nextButton.style.display = currentSlide === totalSlides - 1 ? 'none' : 'flex';
                
                console.log('🔄 Controls updated - slide:', currentSlide + 1);
            }

            // Event Listeners
            prevButton.addEventListener('click', () => {
                console.log('⬅️ Previous button clicked');
                showSlide(currentSlide - 1);
            });
            
            nextButton.addEventListener('click', () => {
                console.log('➡️ Next button clicked');
                showSlide(currentSlide + 1);
            });
            
            // JEDNODUCHÝ FULLSCREEN (zatím bez komplexní logiky)
            fullscreenButton.addEventListener('click', () => {
                console.log('🎯 KLIK NA FULLSCREEN BUTTON');
                const presentationContainer = document.getElementById('presentation-container');
                
                if (presentationContainer.requestFullscreen) {
                    presentationContainer.requestFullscreen();
                } else if (presentationContainer.mozRequestFullScreen) {
                    presentationContainer.mozRequestFullScreen();
                } else if (presentationContainer.webkitRequestFullscreen) {
                    presentationContainer.webkitRequestFullscreen();
                } else if (presentationContainer.msRequestFullscreen) {
                    presentationContainer.msRequestFullscreen();
                }
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight') {
                    console.log('⌨️ Right arrow pressed');
                    showSlide(currentSlide + 1);
                }
                if (e.key === 'ArrowLeft') {
                    console.log('⌨️ Left arrow pressed');
                    showSlide(currentSlide - 1);
                }
            });

            // Přidání zápatí do všech slajdů
            function addFootersToSlides() {
                console.log('📄 Adding footers to slides');
                
                slides.forEach((slide, index) => {
                    // Přeskočit titulní, závěrečný slajd a souhrn
                    if (slide.classList.contains('title-slide') || 
                        slide.classList.contains('final-slide') ||
                        slide.classList.contains('cheat-sheet')) {
                        return;
                    }
                    
                    // Zkontrolovat, zda už zápatí neexistuje
                    if (slide.querySelector('.slide-footer')) {
                        return;
                    }
                    
                    // Vytvoření zápatí
                    const footer = document.createElement('div');
                    footer.className = 'slide-footer';
                    
                    // Určení čísla slajdu (pouze normální slajdy)
                    let pageNum = 0;
                    for(let i = 1; i <= index; i++) {
                        if (!slides[i].classList.contains('title-slide') && 
                            !slides[i].classList.contains('final-slide') &&
                            !slides[i].classList.contains('cheat-sheet')) {
                           pageNum++;
                        }
                    }
                    
                    // Obsah zápatí
                    const totalNormalSlides = totalSlides - 2; // Bez titulního a závěrečného
                    footer.innerHTML = `
                        <div class="footer-left">Hmotnostní a tepelné bilance</div>
                        <div class="footer-right">${pageNum} / ${totalNormalSlides - 1}</div>
                    `;
                    
                    // Přidání zápatí do slajdu
                    slide.appendChild(footer);
                    
                    console.log(`✅ Footer added to slide ${index + 1} (page ${pageNum})`);
                });
            }

            // Initialize
            console.log('🚀 Initializing presentation');
            addFootersToSlides();
            showSlide(0);
            
            // Initialize diagrams
            setTimeout(() => {
                drawSeparatorDiagram();
            }, 100);
            
            // Create charts after initialization
            setTimeout(() => {
                console.log('📈 Creating charts');
                createBalanceScheme();
                createMixerDiagram();
                createSplitterDiagram();
                drawComponentSeparatorSchema();
                createHeatExchangerDiagram();
                createReactorBalance();
                createMixerExampleDiagram();
                createSplitterExampleDiagram();
                createReactorExampleDiagram();
                drawMethodologyDiagram();
                drawDofDiagram();
                drawConversionDiagram();
                createSimpleDividerExampleDiagram();
                // Duplikáty pro záložky "Výsledky"
                createMixerExampleDiagram2();
                createSplitterExampleDiagram2();
                createReactorExampleDiagram2();
                createSimpleDividerExampleDiagram2();
            }, 100);
        });

        // Interactive calculators
        function calculateMixer() {
            const m1 = parseFloat(document.getElementById('mixer-m1').value);
            const t1 = parseFloat(document.getElementById('mixer-t1').value);
            const m2 = parseFloat(document.getElementById('mixer-m2').value);
            const t2 = parseFloat(document.getElementById('mixer-t2').value);
            
            // Validace vstupů
            if (isNaN(m1) || isNaN(m2) || isNaN(t1) || isNaN(t2) || m1 <= 0 || m2 <= 0) {
                alert("Zadejte platné kladné hodnoty!");
                return;
            }
            
            // Výpočty
            const m3 = m1 + m2;
            const t3 = (m1 * t1 + m2 * t2) / m3;
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('mixer-flow').textContent = m3.toFixed(2);
            document.getElementById('mixer-temp').textContent = t3.toFixed(1);
            document.getElementById('mixer-check-mass').textContent = `${m1} + ${m2} = ${m3} ✓`;
            document.getElementById('mixer-check-temp').textContent = `Mezi ${Math.min(t1,t2)} a ${Math.max(t1,t2)} °C ✓`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('mixer-result').classList.add('visible');
        }

        function drawSeparatorDiagram() {
            const canvas = document.getElementById('separatorDiagram');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            // Vyčištění
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Barvy
            const separatorColor = '#4a90e2';
            const pipeColor = '#666';
            const textColor = '#333';
            
            // Rozměry
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const separatorWidth = 80;
            const separatorHeight = 60;
            
            // Kreslení hlavního separátoru
            ctx.fillStyle = separatorColor;
            ctx.fillRect(centerX - separatorWidth/2, centerY - separatorHeight/2, separatorWidth, separatorHeight);
            ctx.strokeStyle = '#2c5282';
            ctx.lineWidth = 2;
            ctx.strokeRect(centerX - separatorWidth/2, centerY - separatorHeight/2, separatorWidth, separatorHeight);
            
            // Text "SEPARÁTOR"
            ctx.fillStyle = 'white';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('SEPARÁTOR', centerX, centerY - 5);
            ctx.fillText('SLOŽEK', centerX, centerY + 10);
            
            // Vstupní potrubí (zleva)
            ctx.strokeStyle = pipeColor;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(50, centerY);
            ctx.lineTo(centerX - separatorWidth/2, centerY);
            ctx.stroke();
            
            // Šipka vstup
            ctx.fillStyle = pipeColor;
            ctx.beginPath();
            ctx.moveTo(centerX - separatorWidth/2 - 10, centerY);
            ctx.lineTo(centerX - separatorWidth/2 - 20, centerY - 5);
            ctx.lineTo(centerX - separatorWidth/2 - 20, centerY + 5);
            ctx.fill();
            
            // Výstupní potrubí 2 (doprava nahoře)
            ctx.beginPath();
            ctx.moveTo(centerX + separatorWidth/2, centerY - 15);
            ctx.lineTo(canvas.width - 50, centerY - 15);
            ctx.stroke();
            
            // Šipka výstup 2
            ctx.fillStyle = pipeColor;
            ctx.beginPath();
            ctx.moveTo(canvas.width - 50, centerY - 15);
            ctx.lineTo(canvas.width - 60, centerY - 20);
            ctx.lineTo(canvas.width - 60, centerY - 10);
            ctx.fill();
            
            // Výstupní potrubí 3 (doprava dole)
            ctx.strokeStyle = pipeColor;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(centerX + separatorWidth/2, centerY + 15);
            ctx.lineTo(canvas.width - 50, centerY + 15);
            ctx.stroke();
            
            // Šipka výstup 3
            ctx.fillStyle = pipeColor;
            ctx.beginPath();
            ctx.moveTo(canvas.width - 50, centerY + 15);
            ctx.lineTo(canvas.width - 60, centerY + 10);
            ctx.lineTo(canvas.width - 60, centerY + 20);
            ctx.fill();
            
            // Popisky
            ctx.fillStyle = textColor;
            ctx.font = '11px Arial';
            ctx.textAlign = 'center';
            
            // Vstup
            ctx.fillText('PROUD 1', 25, centerY - 10);
            ctx.fillText('100 kg/s', 25, centerY + 5);
            ctx.fillText('40% A, 60% B', 25, centerY + 18);
            
            // Výstup 2 (Koncentrát)
            ctx.fillText('PROUD 2', canvas.width - 25, centerY - 35);
            ctx.fillText('50 kg/s', canvas.width - 25, centerY - 22);
            ctx.fillText('64% A, 36% B', canvas.width - 25, centerY - 9);
            
            // Výstup 3 (Zbytek)
            ctx.fillText('PROUD 3', canvas.width - 25, centerY + 35);
            ctx.fillText('50 kg/s', canvas.width - 25, centerY + 48);
            ctx.fillText('16% A, 84% B', canvas.width - 25, centerY + 61);
        }

        function updateSeparatorDiagram(m1, conc_a_in, m2, conc_a_2, conc_b_2, m3, conc_a_3, conc_b_3) {
            const canvas = document.getElementById('separatorDiagram');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            // Vyčištění
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Barvy
            const separatorColor = '#4a90e2';
            const pipeColor = '#666';
            const textColor = '#333';
            
            // Rozměry
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const separatorWidth = 80;
            const separatorHeight = 60;
            
            // Kreslení hlavního separátoru
            ctx.fillStyle = separatorColor;
            ctx.fillRect(centerX - separatorWidth/2, centerY - separatorHeight/2, separatorWidth, separatorHeight);
            ctx.strokeStyle = '#2c5282';
            ctx.lineWidth = 2;
            ctx.strokeRect(centerX - separatorWidth/2, centerY - separatorHeight/2, separatorWidth, separatorHeight);
            
            // Text "SEPARÁTOR"
            ctx.fillStyle = 'white';
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('SEPARÁTOR', centerX, centerY - 5);
            ctx.fillText('SLOŽEK', centerX, centerY + 10);
            
            // Vstupní potrubí (zleva)
            ctx.strokeStyle = pipeColor;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(50, centerY);
            ctx.lineTo(centerX - separatorWidth/2, centerY);
            ctx.stroke();
            
            // Šipka vstup
            ctx.fillStyle = pipeColor;
            ctx.beginPath();
            ctx.moveTo(centerX - separatorWidth/2 - 10, centerY);
            ctx.lineTo(centerX - separatorWidth/2 - 20, centerY - 5);
            ctx.lineTo(centerX - separatorWidth/2 - 20, centerY + 5);
            ctx.fill();
            
            // Výstupní potrubí 2 (doprava nahoře)
            ctx.strokeStyle = pipeColor;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(centerX + separatorWidth/2, centerY - 15);
            ctx.lineTo(canvas.width - 50, centerY - 15);
            ctx.stroke();
            
            // Šipka výstup 2
            ctx.fillStyle = pipeColor;
            ctx.beginPath();
            ctx.moveTo(canvas.width - 50, centerY - 15);
            ctx.lineTo(canvas.width - 60, centerY - 20);
            ctx.lineTo(canvas.width - 60, centerY - 10);
            ctx.fill();
            
            // Výstupní potrubí 3 (doprava dole)
            ctx.strokeStyle = pipeColor;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(centerX + separatorWidth/2, centerY + 15);
            ctx.lineTo(canvas.width - 50, centerY + 15);
            ctx.stroke();
            
            // Šipka výstup 3
            ctx.fillStyle = pipeColor;
            ctx.beginPath();
            ctx.moveTo(canvas.width - 50, centerY + 15);
            ctx.lineTo(canvas.width - 60, centerY + 10);
            ctx.lineTo(canvas.width - 60, centerY + 20);
            ctx.fill();
            
            // Popisky s aktuálními hodnotami
            ctx.fillStyle = textColor;
            ctx.font = '11px Arial';
            ctx.textAlign = 'center';
            
            // Vstup
            ctx.fillText('PROUD 1', 25, centerY - 15);
            ctx.fillText(`${m1} kg/s`, 25, centerY);
            ctx.fillText(`${conc_a_in.toFixed(0)}% A, ${(100-conc_a_in).toFixed(0)}% B`, 25, centerY + 15);
            
            // Výstup 2 (Koncentrát)
            ctx.fillText('PROUD 2', canvas.width - 25, centerY - 40);
            ctx.fillText(`${m2.toFixed(1)} kg/s`, canvas.width - 25, centerY - 25);
            ctx.fillText(`${conc_a_2.toFixed(0)}% A, ${conc_b_2.toFixed(0)}% B`, canvas.width - 25, centerY - 10);
            
            // Výstup 3 (Zbytek)
            ctx.fillText('PROUD 3', canvas.width - 25, centerY + 30);
            ctx.fillText(`${m3.toFixed(1)} kg/s`, canvas.width - 25, centerY + 45);
            ctx.fillText(`${conc_a_3.toFixed(0)}% A, ${conc_b_3.toFixed(0)}% B`, canvas.width - 25, centerY + 60);
        }

        function calculateDivider() {
            const m1 = parseFloat(document.getElementById('divider-m1').value);
            const conc_a = parseFloat(document.getElementById('divider-conc').value) / 100; // 0.4
            const split_a = parseFloat(document.getElementById('divider-split-a').value) / 100; // 0.8
            const split_b = parseFloat(document.getElementById('divider-split-b').value) / 100; // 0.3
            const temp = parseFloat(document.getElementById('divider-temp').value);
            
            // Hmotnosti složek ve vstupním proudu
            const m_a_in = m1 * conc_a; // kg/s složky A
            const m_b_in = m1 * (1 - conc_a); // kg/s složky B
            
            // Separace - kolik z každé složky jde do proudu 2
            const m_a_2 = m_a_in * split_a; // složka A do proudu 2
            const m_b_2 = m_b_in * split_b; // složka B do proudu 2
            const m2 = m_a_2 + m_b_2; // celkový proud 2
            
            // Zbytek jde do proudu 3
            const m_a_3 = m_a_in * (1 - split_a); // složka A do proudu 3
            const m_b_3 = m_b_in * (1 - split_b); // složka B do proudu 3
            const m3 = m_a_3 + m_b_3; // celkový proud 3
            
            // Složení výstupních proudů
            const conc_a_2 = m_a_2 / m2 * 100; // % A v proudu 2
            const conc_b_2 = m_b_2 / m2 * 100; // % B v proudu 2
            const conc_a_3 = m_a_3 / m3 * 100;
            const conc_b_3 = m_b_3 / m3 * 100;
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('div-m2').textContent = m2.toFixed(1);
            document.getElementById('div-a2').textContent = conc_a_2.toFixed(1);
            document.getElementById('div-a2-kg').textContent = m_a_2.toFixed(1);
            document.getElementById('div-b2').textContent = conc_b_2.toFixed(1);
            document.getElementById('div-b2-kg').textContent = m_b_2.toFixed(1);
            document.getElementById('div-m3').textContent = m3.toFixed(1);
            document.getElementById('div-a3').textContent = conc_a_3.toFixed(1);
            document.getElementById('div-a3-kg').textContent = m_a_3.toFixed(1);
            document.getElementById('div-b3').textContent = conc_b_3.toFixed(1);
            document.getElementById('div-b3-kg').textContent = m_b_3.toFixed(1);
            document.getElementById('div-temp').textContent = temp;
            document.getElementById('div-check-total').textContent = `${m2.toFixed(1)} + ${m3.toFixed(1)} = ${(m2+m3).toFixed(1)} kg/s ✓`;
            document.getElementById('div-check-a').textContent = `${m_a_2.toFixed(1)} + ${m_a_3.toFixed(1)} = ${(m_a_2+m_a_3).toFixed(1)} kg/s ✓`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('divider-results').classList.add('visible');
            
            // Aktualizovat diagram s novými hodnotami
            updateSeparatorDiagram(m1, conc_a*100, m2, conc_a_2, conc_b_2, m3, conc_a_3, conc_b_3);
        }

        function calculateHeatExchanger() {
            const mh = parseFloat(document.getElementById('hex-mh').value);
            const th1 = parseFloat(document.getElementById('hex-th1').value);
            const th2 = parseFloat(document.getElementById('hex-th2').value);
            const mc = parseFloat(document.getElementById('hex-mc').value);
            const tc1 = parseFloat(document.getElementById('hex-tc1').value);
            
            // Validace
            if (isNaN(mh) || isNaN(th1) || isNaN(th2) || isNaN(mc) || isNaN(tc1) || mh <= 0 || mc <= 0) {
                alert("Zadejte platné kladné hodnoty!");
                return;
            }
            
            // Výpočty
            const cp = 4.18; // kJ/kg·K pro vodu
            const qh = mh * cp * (th1 - th2);
            const qc = mc * cp;
            const tc2 = tc1 + qh / qc;
            const balance_check = Math.abs(qh - qc * (tc2 - tc1)) < 0.1;
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('hex-qh').textContent = qh.toFixed(1);
            document.getElementById('hex-tc2').textContent = tc2.toFixed(1);
            document.getElementById('hex-balance').textContent = `Q_h = ${qh.toFixed(1)} kW ≈ Q_c = ${(qc * (tc2 - tc1)).toFixed(1)} kW ${balance_check ? '✓' : '✗'}`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('hex-results').classList.add('visible');
        }

        // Chart creation functions
        function createBalanceScheme() {
            const ctx = document.getElementById('balanceScheme');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 500, 400);
            
            // System boundary
            context.strokeStyle = '#003f88';
            context.lineWidth = 3;
            context.setLineDash([6, 6]);
            context.strokeRect(180, 150, 140, 100);
            
            // System label
            context.fillStyle = '#003f88';
            context.font = '16px Inter';
            context.fillText('SYSTÉM', 220, 205);
            
            // Arrows
            context.setLineDash([]);
            context.lineWidth = 3;
            
            // Input
            context.strokeStyle = '#4caf50';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(80, 200);
            context.lineTo(175, 200);
            context.stroke();
            
            // Arrow head for input (směřuje DO systému)
            context.beginPath();
            context.moveTo(175, 200);
            context.lineTo(165, 195);
            context.moveTo(175, 200);
            context.lineTo(165, 205);
            context.stroke();
            
            // Output  
            context.strokeStyle = '#ff5722';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(325, 200);
            context.lineTo(420, 200);
            context.stroke();
            
            // Arrow head for output (OPRAVENO - směřuje ZE systému)
            context.beginPath();
            context.moveTo(420, 200);
            context.lineTo(410, 195);
            context.moveTo(420, 200);
            context.lineTo(410, 205);
            context.stroke();
            
            // Source
            context.strokeStyle = '#9c27b0';
            context.lineWidth = 3;
            context.beginPath();
            context.moveTo(250, 80);
            context.lineTo(250, 145);
            context.stroke();
            
            // Arrow head for source (směřuje DO systému)
            context.beginPath();
            context.moveTo(250, 145);
            context.lineTo(245, 135);
            context.moveTo(250, 145);
            context.lineTo(255, 135);
            context.stroke();
            
            // Sink
            context.strokeStyle = '#f44336';
            context.lineWidth = 3;
            context.beginPath();
            context.moveTo(250, 255);
            context.lineTo(250, 320);
            context.stroke();
            
            // Arrow head for sink (OPRAVENO - směřuje ZE systému)
            context.beginPath();
            context.moveTo(250, 320);
            context.lineTo(245, 310);
            context.moveTo(250, 320);
            context.lineTo(255, 310);
            context.stroke();
            
            // Labels
            context.fillStyle = '#333';
            context.font = '14px Inter';
            context.fillText('VSTUP', 110, 190);
            context.fillText('VÝSTUP', 360, 190);
            context.fillText('ZDROJ', 210, 70);
            context.fillText('SPOTŘEBA', 190, 345);
        }

        function createMixerDiagram() {
            const ctx = document.getElementById('mixerDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 500, 400);
            
            // Mixer - ZVĚTŠENÝ obdelník z 50x30 na 80x50
            context.fillStyle = '#e3f2fd';
            context.fillRect(200, 175, 80, 50);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(200, 175, 80, 50);
            
            // Streams
            context.lineWidth = 4;
            
            // Input 1
            context.strokeStyle = '#4caf50';
            context.beginPath();
            context.moveTo(80, 185);
            context.lineTo(195, 185);
            context.stroke();
            
            // Input 2
            context.strokeStyle = '#2196f3';
            context.beginPath();
            context.moveTo(80, 215);
            context.lineTo(195, 215);
            context.stroke();
            
            // Output
            context.strokeStyle = '#ff9800';
            context.lineWidth = 5;
            context.beginPath();
            context.moveTo(285, 200);
            context.lineTo(420, 200);
            context.stroke();
            
            // Labels
            context.fillStyle = '#333';
            context.font = '14px Inter';
            context.fillText('ṁ₁, T₁', 90, 175);
            context.fillText('ṁ₂, T₂', 90, 210);
            context.fillText('ṁ₃, T₃', 340, 190);
            context.fillStyle = '#1976d2';
            context.font = '16px Inter';
            context.fillText('MIX', 225, 205);
        }

        function createSplitterDiagram() {
            const ctx = document.getElementById('splitterDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 500, 400);
            
            // Splitter - ZVĚTŠENÝ obdelník z 30x20 na 60x40
            context.fillStyle = '#e3f2fd';
            context.fillRect(220, 180, 60, 40);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(220, 180, 60, 40);
            
            // Streams
            context.lineWidth = 4;
            
            // Input
            context.strokeStyle = '#4caf50';
            context.beginPath();
            context.moveTo(80, 200);
            context.lineTo(215, 200);
            context.stroke();
            
            // Output 1
            context.strokeStyle = '#ff9800';
            context.beginPath();
            context.moveTo(285, 200);
            context.lineTo(420, 160);
            context.stroke();
            
            // Output 2
            context.strokeStyle = '#f44336';
            context.beginPath();
            context.moveTo(285, 200);
            context.lineTo(420, 240);
            context.stroke();
            
            // Labels
            context.fillStyle = '#333';
            context.font = '14px Inter';
            context.fillText('ṁ₁, T₁, x₁', 90, 190);
            context.fillText('ṁ₂, T₁, x₁', 340, 150);
            context.fillText('ṁ₃, T₁, x₁', 340, 255);
            context.fillStyle = '#1976d2';
            context.font = '16px Inter';
            context.fillText('SPLIT', 235, 205);
            context.font = '14px Inter';
            context.fillText('T₁ = T₂ = T₃', 180, 280);
            context.fillText('x₁ = x₂ = x₃', 120, 195);
        }

        function drawComponentSeparatorSchema() {
            const canvas = document.getElementById('componentSeparatorSchema');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Pozadí
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Vstupní proud
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(50, 200);
            ctx.lineTo(150, 200);
            ctx.stroke();
            
            // Separátor - obdélník
            ctx.fillStyle = '#4a90e2';
            ctx.fillRect(150, 150, 120, 100);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.strokeRect(150, 150, 120, 100);
            
            // Text separátoru
            ctx.fillStyle = 'white';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('SEPARÁTOR', 210, 195);
            ctx.fillText('SLOŽEK', 210, 210);
            
            // Výstupní proudy
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            // Proud 2 (nahoře)
            ctx.beginPath();
            ctx.moveTo(270, 170);
            ctx.lineTo(400, 170);
            ctx.stroke();
            
            // Proud 3 (dole)
            ctx.beginPath();
            ctx.moveTo(270, 230);
            ctx.lineTo(400, 230);
            ctx.stroke();
            
            // Šipky
            ctx.fillStyle = '#333';
            // Vstupní šipka
            ctx.beginPath();
            ctx.moveTo(145, 200);
            ctx.lineTo(135, 195);
            ctx.lineTo(135, 205);
            ctx.closePath();
            ctx.fill();
            
            // Výstupní šipky
            ctx.beginPath();
            ctx.moveTo(395, 170);
            ctx.lineTo(405, 165);
            ctx.lineTo(405, 175);
            ctx.closePath();
            ctx.fill();
            
            ctx.beginPath();
            ctx.moveTo(395, 230);
            ctx.lineTo(405, 225);
            ctx.lineTo(405, 235);
            ctx.closePath();
            ctx.fill();
            
            // Popisy proudů
            ctx.fillStyle = '#333';
            ctx.font = 'bold 12px Inter';
            ctx.textAlign = 'center';
            
            // Vstup
            ctx.fillText('PROUD 1', 100, 185);
            ctx.font = '10px Inter';
            ctx.fillText('100 kg/s', 100, 220);
            ctx.fillText('40% A, 60% B', 100, 232);
            
            // Výstup 2 (koncentrát)
            ctx.font = 'bold 12px Inter';
            ctx.fillText('PROUD 2', 350, 155);
            ctx.fillText('(Koncentrát)', 350, 140);
            ctx.font = '10px Inter';
            ctx.fillText('50 kg/s', 350, 185);
            ctx.fillText('64% A, 36% B', 350, 197);
            
            // Výstup 3 (zbytek)
            ctx.font = 'bold 12px Inter';
            ctx.fillText('PROUD 3', 350, 245);
            ctx.fillText('(Zbytek)', 350, 260);
            ctx.font = '10px Inter';
            ctx.fillText('50 kg/s', 350, 215);
            ctx.fillText('16% A, 84% B', 350, 203);
            
            // Klíčový princip
            ctx.fillStyle = '#e74c3c';
            ctx.font = 'bold 11px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('ROZDÍLNÉ SLOŽENÍ VÝSTUPŮ!', 210, 290);
            
            // Teplota
            ctx.fillStyle = '#27ae60';
            ctx.font = '10px Inter';
            ctx.fillText('T₁ = T₂ = T₃ = 80°C', 210, 305);
        }

        function createHeatExchangerDiagram() {
            const ctx = document.getElementById('heatExchangerDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 500, 400);
            
            // Heat exchanger - ZVĚTŠENÝ obdelník z 110x90 na 160x120
            context.fillStyle = '#e3f2fd';
            context.fillRect(170, 140, 160, 120);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(170, 140, 160, 120);
            
            // Hot stream
            context.strokeStyle = '#f44336';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(60, 180);
            context.lineTo(420, 180);
            context.stroke();
            
            // Cold stream
            context.strokeStyle = '#2196f3';
            context.beginPath();
            context.moveTo(420, 220);
            context.lineTo(60, 220);
            context.stroke();
            
            // Labels
            context.fillStyle = '#333';
            context.font = '14px Inter';
            context.fillText('T_h,in', 70, 170);
            context.fillText('T_h,out', 350, 170);
            context.fillText('T_c,out', 70, 240);
            context.fillText('T_c,in', 350, 240);
            
            // Heat transfer
            context.fillStyle = '#ff9800';
            context.font = '20px Inter';
            context.fillText('Q', 240, 205);
            
            context.fillStyle = '#1976d2';
            context.font = '16px Inter';
            context.fillText('HEAT EXCHANGER', 200, 130);
        }

        function createReactorBalance() {
            const ctx = document.getElementById('reactorBalance');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['0', '25', '50', '75', '100'],
                    datasets: [{
                        label: 'N₂',
                        data: [100, 75, 50, 25, 0],
                        borderColor: '#1976d2',
                        tension: 0.1,
                        borderWidth: 2
                    }, {
                        label: 'H₂', 
                        data: [300, 225, 150, 75, 0],
                        borderColor: '#4caf50',
                        tension: 0.1,
                        borderWidth: 2
                    }, {
                        label: 'NH₃',
                        data: [0, 50, 100, 150, 200],
                        borderColor: '#ff9800',
                        tension: 0.1,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'N₂ + 3H₂ → 2NH₃',
                            font: { size: 14 }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Konverze (%)' } },
                        y: { title: { display: true, text: 'Tok (mol/s)' } }
                    }
                }
            });
        }

        // INTERAKTIVNÍ PŘÍKLADY - FUNKCE PRO PŘEPÍNÁNÍ TABŮ
        function switchTab(example, tab) {
            // Deaktivovat všechny taby a obsah pro daný příklad
            document.querySelectorAll(`#${example}-zadani, #${example}-postup, #${example}-reseni, #${example}-vysledky, #${example}-chyby`).forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll(`.example-tab`).forEach(tabBtn => {
                tabBtn.classList.remove('active');
            });
            
            // Aktivovat vybraný tab a obsah
            const targetContent = document.getElementById(`${example}-${tab}`);
            const targetTab = event.target;
            
            if (targetContent && targetTab) {
                targetContent.classList.add('active');
                targetTab.classList.add('active');
            }
        }

        // INTERAKTIVNÍ VÝPOČTY
        function solveMixer() {
            const m1 = parseFloat(document.getElementById('mixer-m1').value);
            const w1 = parseFloat(document.getElementById('mixer-w1').value) / 100;
            const m2 = parseFloat(document.getElementById('mixer-m2').value);
            const w2 = parseFloat(document.getElementById('mixer-w2').value) / 100;
            
            // Validace
            if (isNaN(m1) || isNaN(m2) || isNaN(w1*100) || isNaN(w2*100) || m1 <= 0 || m2 <= 0) {
                alert("Zadejte platné kladné hodnoty!");
                return;
            }
            
            // Výpočty
            const m3 = m1 + m2;
            const w3 = (m1 * w1 + m2 * w2) / m3;
            const tempEstimate = 25 + (w3*100 - w1*100) * 2;
            
            // Kontroly
            const checks = [];
            if (w3 > Math.min(w1, w2) && w3 < Math.max(w1, w2)) {
                checks.push(`✓ Koncentrace ${(w3*100).toFixed(1)}% je mezi krajními hodnotami`);
            } else {
                checks.push(`⚠️ Koncentrace mimo očekávaný rozsah`);
            }
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('mixer-mass-balance').textContent = `${m1} + ${m2} = ${m3.toFixed(0)} kg/h`;
            document.getElementById('mixer-component-balance').textContent = `${m1} × ${w1.toFixed(2)} + ${m2} × ${w2.toFixed(2)} = ${m3} × ${w3.toFixed(3)}`;
            document.getElementById('mixer-component-kg').textContent = `${(m1*w1).toFixed(1)} + ${(m2*w2).toFixed(1)} = ${(m3*w3).toFixed(1)} kg/h H₂SO₄`;
            document.getElementById('mixer-final-conc').textContent = `${(w3*100).toFixed(1)} % hm.`;
            document.getElementById('mixer-checks').innerHTML = `<b>Tepelná bilance:</b><br>Teplota směsi: přibližně ${tempEstimate.toFixed(0)}°C<br>${checks.join('<br>')}`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('mixer-result').classList.add('visible');
        }

        // Funkce pro slajd 14 - s ID mixer2-*
        function solveMixer2() {
            const m1 = parseFloat(document.getElementById('mixer2-m1').value);
            const w1 = parseFloat(document.getElementById('mixer2-w1').value) / 100;
            const m2 = parseFloat(document.getElementById('mixer2-m2').value);
            const w2 = parseFloat(document.getElementById('mixer2-w2').value) / 100;
            
            // Validace
            if (isNaN(m1) || isNaN(m2) || isNaN(w1*100) || isNaN(w2*100) || m1 <= 0 || m2 <= 0) {
                alert("Zadejte platné kladné hodnoty!");
                return;
            }
            
            // Výpočty
            const m3 = m1 + m2;
            const w3 = (m1 * w1 + m2 * w2) / m3;
            const tempEstimate = 25 + (w3*100 - w1*100) * 2;
            
            // Kontroly
            const checks = [];
            if (w3 > Math.min(w1, w2) && w3 < Math.max(w1, w2)) {
                checks.push(`✓ Koncentrace ${(w3*100).toFixed(1)}% je mezi krajními hodnotami`);
            } else {
                checks.push(`⚠️ Koncentrace mimo očekávaný rozsah`);
            }
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('mixer2-mass-balance').textContent = `${m1} + ${m2} = ${m3.toFixed(0)} kg/h`;
            document.getElementById('mixer2-component-balance').textContent = `${m1} × ${w1.toFixed(2)} + ${m2} × ${w2.toFixed(2)} = ${m3} × ${w3.toFixed(3)}`;
            document.getElementById('mixer2-component-kg').textContent = `${(m1*w1).toFixed(1)} + ${(m2*w2).toFixed(1)} = ${(m3*w3).toFixed(1)} kg/h H₂SO₄`;
            document.getElementById('mixer2-final-conc').textContent = `${(w3*100).toFixed(1)} % hm.`;
            document.getElementById('mixer2-checks').innerHTML = `<b>Tepelná bilance:</b><br>Teplota směsi: přibližně ${tempEstimate.toFixed(0)}°C<br>${checks.join('<br>')}`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('mixer2-result').classList.add('visible');
        }

        function solveSplitter() {
            const m1 = parseFloat(document.getElementById('splitter-m1').value);
            const split = parseFloat(document.getElementById('splitter-split').value) / 100;
            
            // Validace
            if (isNaN(m1) || isNaN(split*100) || m1 <= 0 || split <= 0 || split >= 1) {
                alert("Zadejte platné hodnoty! Split musí být mezi 0-100%.");
                return;
            }
            
            // Výpočty
            const m2 = m1 * split;
            const m3 = m1 * (1 - split);
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('splitter-m2').textContent = m2.toFixed(0);
            document.getElementById('splitter-perc2').textContent = (split*100).toFixed(0);
            document.getElementById('splitter-m3').textContent = m3.toFixed(0);
            document.getElementById('splitter-perc3').textContent = ((1-split)*100).toFixed(0);
            document.getElementById('splitter-check').textContent = `${m2.toFixed(0)} + ${m3.toFixed(0)} = ${(m2+m3).toFixed(0)} kg/h ✓`;
            document.getElementById('splitter-notes').innerHTML = `<b>Složení obou proudů:</b> nezměněno<br><b>Teplota:</b> T₁ = T₂ = T₃ (nezměněno)`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('splitter-result').classList.add('visible');
        }

        function solveSimpleDivider() {
            const m1 = parseFloat(document.getElementById('simple-divider-m1').value);
            const conc_eth = parseFloat(document.getElementById('simple-divider-conc').value) / 100;
            const eth_sep = parseFloat(document.getElementById('simple-divider-eth-sep').value) / 100;
            const water_sep = parseFloat(document.getElementById('simple-divider-water-sep').value) / 100;
            const temp = parseFloat(document.getElementById('simple-divider-temp').value);
            
            // Validace
            if (isNaN(m1) || isNaN(conc_eth*100) || isNaN(eth_sep*100) || isNaN(water_sep*100) || m1 <= 0) {
                alert("Zadejte platné hodnoty!");
                return;
            }
            
            // Hmotnosti složek ve vstupním proudu
            const m_eth_in = m1 * conc_eth;
            const m_water_in = m1 * (1 - conc_eth);
            
            // Separace - kolik z každé složky jde do proudu 2
            const m_eth_2 = m_eth_in * eth_sep;
            const m_water_2 = m_water_in * water_sep;
            const m2 = m_eth_2 + m_water_2;
            
            // Zbytek jde do proudu 3
            const m_eth_3 = m_eth_in * (1 - eth_sep);
            const m_water_3 = m_water_in * (1 - water_sep);
            const m3 = m_eth_3 + m_water_3;
            
            // Složení výstupních proudů
            const conc_eth_2 = m_eth_2 / m2 * 100;
            const conc_water_2 = m_water_2 / m2 * 100;
            const conc_eth_3 = m_eth_3 / m3 * 100;
            const conc_water_3 = m_water_3 / m3 * 100;
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('sep-m2').textContent = m2.toFixed(0);
            document.getElementById('sep-eth2').textContent = conc_eth_2.toFixed(1);
            document.getElementById('sep-eth2-kg').textContent = m_eth_2.toFixed(0);
            document.getElementById('sep-water2').textContent = conc_water_2.toFixed(1);
            document.getElementById('sep-water2-kg').textContent = m_water_2.toFixed(0);
            document.getElementById('sep-m3').textContent = m3.toFixed(0);
            document.getElementById('sep-eth3').textContent = conc_eth_3.toFixed(1);
            document.getElementById('sep-eth3-kg').textContent = m_eth_3.toFixed(0);
            document.getElementById('sep-water3').textContent = conc_water_3.toFixed(1);
            document.getElementById('sep-water3-kg').textContent = m_water_3.toFixed(0);
            document.getElementById('sep-check').textContent = `${m2.toFixed(0)} + ${m3.toFixed(0)} = ${(m2+m3).toFixed(0)} kg/h ✓`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('simple-divider-result').classList.add('visible');
        }

        // DIAGRAMY PRO PŘÍKLADY
        function createMixerExampleDiagram() {
            const ctx = document.getElementById('mixerExampleDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Mixer box
            context.fillStyle = '#e3f2fd';
            context.fillRect(175, 125, 60, 40);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(175, 125, 60, 40);
            
            // Input streams
            context.lineWidth = 4;
            
            // Input 1 (20% H2SO4)
            context.strokeStyle = '#4caf50';
            context.beginPath();
            context.moveTo(50, 135);
            context.lineTo(170, 135);
            context.stroke();
            
            // Arrow for input 1
            context.beginPath();
            context.moveTo(170, 135);
            context.lineTo(160, 130);
            context.moveTo(170, 135);
            context.lineTo(160, 140);
            context.stroke();
            
            // Input 2 (98% H2SO4)
            context.strokeStyle = '#ff9800';
            context.beginPath();
            context.moveTo(50, 155);
            context.lineTo(170, 155);
            context.stroke();
            
            // Arrow for input 2
            context.beginPath();
            context.moveTo(170, 155);
            context.lineTo(160, 150);
            context.moveTo(170, 155);
            context.lineTo(160, 160);
            context.stroke();
            
            // Output stream
            context.strokeStyle = '#2196f3';
            context.lineWidth = 5;
            context.beginPath();
            context.moveTo(240, 145);
            context.lineTo(350, 145);
            context.stroke();
            
            // Arrow for output
            context.beginPath();
            context.moveTo(350, 145);
            context.lineTo(340, 140);
            context.moveTo(350, 145);
            context.lineTo(340, 150);
            context.stroke();
            
            // Labels - VĚTŠÍ A ČITELNĚJŠÍ TEXT
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('200 kg/h', 55, 125);
            context.fillText('20% H₂SO₄', 55, 140);
            context.fillText('50 kg/h', 55, 170);
            context.fillText('98% H₂SO₄', 55, 185);
            context.fillText('? kg/h', 275, 130);
            context.fillText('? % H₂SO₄', 275, 160);
            
            context.fillStyle = '#1976d2';
            context.font = 'bold 16px Inter';
            context.fillText('MIX', 190, 150);
        }

        function createSplitterExampleDiagram() {
            const ctx = document.getElementById('splitterExampleDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Splitter box
            context.fillStyle = '#e3f2fd';
            context.fillRect(175, 135, 50, 30);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(175, 135, 50, 30);
            
            // Input stream
            context.strokeStyle = '#4caf50';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(50, 150);
            context.lineTo(170, 150);
            context.stroke();
            
            // Arrow for input
            context.beginPath();
            context.moveTo(170, 150);
            context.lineTo(160, 145);
            context.moveTo(170, 150);
            context.lineTo(160, 155);
            context.stroke();
            
            // Output 1 (70%)
            context.strokeStyle = '#2196f3';
            context.beginPath();
            context.moveTo(230, 150);
            context.lineTo(350, 120);
            context.stroke();
            
            // Arrow for output 1
            context.beginPath();
            context.moveTo(350, 120);
            context.lineTo(340, 125);
            context.moveTo(350, 120);
            context.lineTo(345, 130);
            context.stroke();
            
            // Output 2 (30%)
            context.strokeStyle = '#ff9800';
            context.beginPath();
            context.moveTo(230, 150);
            context.lineTo(350, 180);
            context.stroke();
            
            // Arrow for output 2
            context.beginPath();
            context.moveTo(350, 180);
            context.lineTo(340, 175);
            context.moveTo(350, 180);
            context.lineTo(345, 170);
            context.stroke();
            
            // Labels - VĚTŠÍ A ČITELNĚJŠÍ TEXT
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('500 kg/h', 55, 130);
            context.fillText('60% toluen', 55, 145);
            context.fillText('40% benzen', 55, 160);
            
            context.fillText('70% = ? kg/h', 270, 100);
            context.fillText('60% toluen', 270, 115);
            context.fillText('40% benzen', 270, 130);
            
            context.fillText('30% = ? kg/h', 270, 190);
            context.fillText('60% toluen', 270, 205);
            context.fillText('40% benzen', 270, 220);
            
            context.fillStyle = '#1976d2';
            context.font = 'bold 16px Inter';
            context.fillText('SPLIT', 180, 155);
        }

        function createReactorExampleDiagram() {
            const ctx = document.getElementById('reactorExampleDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Reactor vessel
            context.fillStyle = '#fff3e0';
            context.fillRect(160, 120, 80, 60);
            context.strokeStyle = '#ff6f00';
            context.lineWidth = 3;
            context.strokeRect(160, 120, 80, 60);
            
            // Input stream 1 (N2)
            context.strokeStyle = '#4caf50';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(50, 140);
            context.lineTo(155, 140);
            context.stroke();
            
            // Arrow for input 1
            context.beginPath();
            context.moveTo(155, 140);
            context.lineTo(145, 135);
            context.moveTo(155, 140);
            context.lineTo(145, 145);
            context.stroke();
            
            // Input stream 2 (H2)
            context.strokeStyle = '#2196f3';
            context.beginPath();
            context.moveTo(50, 160);
            context.lineTo(155, 160);
            context.stroke();
            
            // Arrow for input 2
            context.beginPath();
            context.moveTo(155, 160);
            context.lineTo(145, 155);
            context.moveTo(155, 160);
            context.lineTo(145, 165);
            context.stroke();
            
            // Output stream (NH3)
            context.strokeStyle = '#e91e63';
            context.beginPath();
            context.moveTo(245, 150);
            context.lineTo(350, 150);
            context.stroke();
            
            // Arrow for output
            context.beginPath();
            context.moveTo(350, 150);
            context.lineTo(340, 145);
            context.moveTo(350, 150);
            context.lineTo(340, 155);
            context.stroke();
            
            // Labels - VĚTŠÍ A ČITELNĚJŠÍ TEXT
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('? mol/h N₂', 5, 125);
            context.fillText('100 mol/h H₂', 5, 145);
            context.fillText('konverze 80%', 5, 175);
            context.fillText('? mol/h NH₃', 270, 135);
            context.fillText('+ zbytek N₂,H₂', 270, 165);
            
            context.fillStyle = '#ff6f00';
            context.font = 'bold 16px Inter';
            context.fillText('REAKTOR', 170, 155);
            
            // Reakce
            context.fillStyle = '#000';
            context.font = 'bold 12px Inter';
            context.fillText('N₂ + 3H₂ → 2NH₃', 165, 200);
        }

        function solveReactor() {
            const h2Input = parseFloat(document.getElementById('reactorH2Input').value);
            const conversion = parseFloat(document.getElementById('reactorConversionInput').value) / 100;
            
            // Validace
            if (isNaN(h2Input) || isNaN(conversion) || h2Input <= 0 || conversion <= 0 || conversion >= 1) {
                alert('Zadejte platné hodnoty! Konverze musí být mezi 0-100%.');
                return;
            }
            
            // Stechiometrické poměry: N2 + 3H2 → 2NH3
            const n2Input = h2Input / 3; // Stechiometrický poměr N2:H2 = 1:3
            
            // Reakční extent při dané konverzi N2
            const xi = conversion * n2Input;
            
            // Výstupy podle bilanční rovnice: n_out = n_in + nu * xi
            const n2_out = n2Input - xi;     // nu_N2 = -1
            const h2_out = h2Input - 3 * xi; // nu_H2 = -3  
            const nh3_out = 0 + 2 * xi;      // nu_NH3 = +2
            
            // Hmotnostní bilance (g/h)
            const mass_in = n2Input * 28 + h2Input * 2;
            const mass_out = n2_out * 28 + h2_out * 2 + nh3_out * 17;
            const balance_ok = Math.abs(mass_in - mass_out) < 0.1;
            
            // Aktualizace statických elementů - ŽÁDNÝ innerHTML!
            document.getElementById('react-n2-in').textContent = n2Input.toFixed(1);
            document.getElementById('react-h2-in').textContent = h2Input.toFixed(1);
            document.getElementById('react-n2-out').textContent = n2_out.toFixed(1);
            document.getElementById('react-h2-out').textContent = h2_out.toFixed(1);
            document.getElementById('react-nh3-out').textContent = nh3_out.toFixed(1);
            document.getElementById('react-check').textContent = `${mass_in.toFixed(1)} g/h in = ${mass_out.toFixed(1)} g/h out ${balance_ok ? '✓' : '✗'}`;
            document.getElementById('react-conv').textContent = `${(conversion*100).toFixed(1)}% N₂`;
            document.getElementById('react-extent').textContent = `ξ = ${xi.toFixed(1)} mol/h`;
            
            // Zviditelnění bez změny layoutu
            document.getElementById('reactor-result').classList.add('visible');
        }

        function createSimpleDividerExampleDiagram() {
            const ctx = document.getElementById('simpleDividerExampleDiagram');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Divider box
            context.fillStyle = '#fff3e0';
            context.fillRect(175, 135, 50, 30);
            context.strokeStyle = '#ff9800';
            context.lineWidth = 3;
            context.strokeRect(175, 135, 50, 30);
            
            // Input stream
            context.strokeStyle = '#4caf50';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(50, 150);
            context.lineTo(170, 150);
            context.stroke();
            
            // Arrow for input
            context.beginPath();
            context.moveTo(170, 150);
            context.lineTo(160, 145);
            context.moveTo(170, 150);
            context.lineTo(160, 155);
            context.stroke();
            
            // Output 1 (prodej - 75%)
            context.strokeStyle = '#2196f3';
            context.beginPath();
            context.moveTo(230, 150);
            context.lineTo(350, 120);
            context.stroke();
            
            // Arrow for output 1
            context.beginPath();
            context.moveTo(350, 120);
            context.lineTo(340, 125);
            context.moveTo(350, 120);
            context.lineTo(345, 130);
            context.stroke();
            
            // Output 2 (recykl - 25%)
            context.strokeStyle = '#9c27b0';
            context.beginPath();
            context.moveTo(230, 150);
            context.lineTo(350, 180);
            context.stroke();
            
            // Arrow for output 2
            context.beginPath();
            context.moveTo(350, 180);
            context.lineTo(340, 175);
            context.moveTo(350, 180);
            context.lineTo(345, 170);
            context.stroke();
            
            // Labels - VĚTŠÍ A ČITELNĚJŠÍ TEXT s správnými hodnotami separátoru
            context.fillStyle = '#000';
            context.font = 'bold 13px Inter';
            context.fillText('1000 kg/h VSTUP', 45, 125);
            context.fillText('40% etanol', 55, 140);
            context.fillText('80°C', 70, 155);
            
            context.fillText('500 kg/h PROUD 1', 245, 95);
            context.fillText('64% etanol', 255, 110);
            context.fillText('36% voda', 255, 125);
            
            context.fillText('500 kg/h PROUD 2', 245, 190);
            context.fillText('16% etanol', 255, 205);
            context.fillText('84% voda', 255, 220);
            
            context.fillStyle = '#ff9800';
            context.font = 'bold 14px Inter';
            context.fillText('SEP', 185, 155);
        }

        // Duplikační funkce pro záložky "Výsledky"
        function createMixerExampleDiagram2() {
            const ctx = document.getElementById('mixerExampleDiagram2');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Mixer box
            context.fillStyle = '#e3f2fd';
            context.fillRect(175, 125, 60, 40);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(175, 125, 60, 40);
            
            // Input streams
            context.strokeStyle = '#4caf50';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(50, 135);
            context.lineTo(170, 135);
            context.stroke();
            
            context.strokeStyle = '#ff9800';
            context.beginPath();
            context.moveTo(50, 155);
            context.lineTo(170, 155);
            context.stroke();
            
            // Output stream
            context.strokeStyle = '#e91e63';
            context.beginPath();
            context.moveTo(240, 145);
            context.lineTo(350, 145);
            context.stroke();
            
            // Arrows
            context.beginPath();
            context.moveTo(170, 135);
            context.lineTo(160, 130);
            context.moveTo(170, 135);
            context.lineTo(160, 140);
            context.stroke();
            
            context.strokeStyle = '#ff9800';
            context.beginPath();
            context.moveTo(170, 155);
            context.lineTo(160, 150);
            context.moveTo(170, 155);
            context.lineTo(160, 160);
            context.stroke();
            
            context.strokeStyle = '#e91e63';
            context.beginPath();
            context.moveTo(350, 145);
            context.lineTo(340, 140);
            context.moveTo(350, 145);
            context.lineTo(340, 150);
            context.stroke();
            
            // Labels
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('200 kg/h', 55, 125);
            context.fillText('20% H₂SO₄', 55, 140);
            context.fillText('50 kg/h', 55, 170);
            context.fillText('98% H₂SO₄', 55, 185);
            context.fillText('? kg/h', 275, 130);
            context.fillText('? % H₂SO₄', 275, 160);
            
            context.fillStyle = '#1976d2';
            context.font = 'bold 16px Inter';
            context.fillText('MIX', 190, 150);
        }

        function createSplitterExampleDiagram2() {
            const ctx = document.getElementById('splitterExampleDiagram2');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Splitter box
            context.fillStyle = '#e3f2fd';
            context.fillRect(175, 135, 50, 30);
            context.strokeStyle = '#1976d2';
            context.lineWidth = 3;
            context.strokeRect(175, 135, 50, 30);
            
            // Input and output streams with arrows and labels (same as original)
            context.strokeStyle = '#4caf50';
            context.lineWidth = 4;
            context.beginPath();
            context.moveTo(50, 150);
            context.lineTo(170, 150);
            context.stroke();
            
            // Arrows and labels - same as original splitter diagram
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('500 kg/h', 55, 130);
            context.fillText('60% toluen', 55, 145);
            
            context.fillStyle = '#1976d2';
            context.font = 'bold 16px Inter';
            context.fillText('SPLIT', 180, 155);
        }

        function createReactorExampleDiagram2() {
            const ctx = document.getElementById('reactorExampleDiagram2');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Reactor vessel (same as original)
            context.fillStyle = '#fff3e0';
            context.fillRect(160, 120, 80, 60);
            context.strokeStyle = '#ff6f00';
            context.lineWidth = 3;
            context.strokeRect(160, 120, 80, 60);
            
            // Labels and streams (same as original)
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('? mol/h N₂', 5, 125);
            context.fillText('100 mol/h H₂', 5, 145);
            
            context.fillStyle = '#ff6f00';
            context.font = 'bold 16px Inter';
            context.fillText('REAKTOR', 170, 155);
        }

        function createSimpleDividerExampleDiagram2() {
            const ctx = document.getElementById('simpleDividerExampleDiagram2');
            if (!ctx) return;
            
            const context = ctx.getContext('2d');
            context.clearRect(0, 0, 400, 300);
            
            // Divider box (same as original)
            context.fillStyle = '#fff3e0';
            context.fillRect(175, 135, 50, 30);
            context.strokeStyle = '#ff9800';
            context.lineWidth = 3;
            context.strokeRect(175, 135, 50, 30);
            
            // Labels (same as original)
            context.fillStyle = '#000';
            context.font = 'bold 14px Inter';
            context.fillText('1000 kg/h', 55, 125);
            context.fillText('40% etanol', 55, 140);
            
            context.fillStyle = '#ff9800';
            context.font = 'bold 16px Inter';
            context.fillText('DIV', 185, 155);
        }

        function drawMethodologyDiagram() {
            const canvas = document.getElementById('methodologyDiagram');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Pozadí
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Flowchart kroků
            const steps = [
                { x: 100, y: 50, text: '1. POCHOP', color: '#e3f2fd' },
                { x: 300, y: 50, text: '2. SCHÉMA', color: '#f3e5f5' },
                { x: 100, y: 130, text: '3. ZÁKLAD', color: '#e8f5e8' },
                { x: 300, y: 130, text: '4. ROVNICE', color: '#fff3e0' },
                { x: 100, y: 210, text: '5. DOF', color: '#ffebee' },
                { x: 300, y: 210, text: '6. ŘEŠÍM', color: '#e1f5fe' },
                { x: 200, y: 290, text: '7. KONTROLA', color: '#f1f8e9' }
            ];
            
            // Kreslení boxů a textu
            steps.forEach(step => {
                // Box
                ctx.fillStyle = step.color;
                ctx.fillRect(step.x - 40, step.y - 20, 80, 40);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.strokeRect(step.x - 40, step.y - 20, 80, 40);
                
                // Text
                ctx.fillStyle = '#333';
                ctx.font = 'bold 11px Inter';
                ctx.textAlign = 'center';
                ctx.fillText(step.text, step.x, step.y + 3);
            });
            
            // Šipky mezi kroky
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            
            // 1 → 2
            ctx.beginPath();
            ctx.moveTo(140, 50);
            ctx.lineTo(260, 50);
            ctx.stroke();
            
            // 2 → 3  
            ctx.beginPath();
            ctx.moveTo(300, 70);
            ctx.lineTo(300, 100);
            ctx.lineTo(100, 100);
            ctx.lineTo(100, 110);
            ctx.stroke();
            
            // 3 → 4
            ctx.beginPath();
            ctx.moveTo(140, 130);
            ctx.lineTo(260, 130);
            ctx.stroke();
            
            // 4 → 5
            ctx.beginPath();
            ctx.moveTo(300, 150);
            ctx.lineTo(300, 180);
            ctx.lineTo(100, 180);
            ctx.lineTo(100, 190);
            ctx.stroke();
            
            // 5 → 6
            ctx.beginPath();
            ctx.moveTo(140, 210);
            ctx.lineTo(260, 210);
            ctx.stroke();
            
            // 6 → 7
            ctx.beginPath();
            ctx.moveTo(300, 230);
            ctx.lineTo(300, 270);
            ctx.lineTo(240, 270);
            ctx.stroke();
            
            // Šipky (hlavy)
            const arrows = [
                { x: 260, y: 50 },
                { x: 100, y: 110 },
                { x: 260, y: 130 },
                { x: 100, y: 190 },
                { x: 260, y: 210 },
                { x: 240, y: 270 }
            ];
            
            arrows.forEach(arrow => {
                ctx.fillStyle = '#666';
                ctx.beginPath();
                ctx.moveTo(arrow.x, arrow.y);
                ctx.lineTo(arrow.x - 5, arrow.y - 3);
                ctx.lineTo(arrow.x - 5, arrow.y + 3);
                ctx.closePath();
                ctx.fill();
            });
            
            // Důraz na DOF
            ctx.fillStyle = '#d32f2f';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('DOF = 0?', 400, 210);
            
            // Poznámka
            ctx.fillStyle = '#666';
            ctx.font = '10px Inter';
            ctx.textAlign = 'left';
            ctx.fillText('DOF = Stupně volnosti', 350, 240);
            ctx.fillText('(Degrees of Freedom)', 350, 252);
        }

        function drawDofDiagram() {
            const canvas = document.getElementById('dofDiagram');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Pozadí
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Tři případy DOF
            const cases = [
                { x: 100, y: 100, dof: -1, color: '#ffcdd2', label: 'DOF < 0', desc: 'PŘESPECIFIKOVANÝ\nŽádné řešení' },
                { x: 250, y: 100, dof: 0, color: '#c8e6c9', label: 'DOF = 0', desc: 'SPRÁVNĚ URČENÝ\nJediné řešení' },
                { x: 400, y: 100, dof: 1, color: '#fff3e0', label: 'DOF > 0', desc: 'PODSPECIFIKOVANÝ\nNekonečně řešení' }
            ];
            
            // Kreslení boxů pro jednotlivé případy
            cases.forEach(case_ => {
                // Hlavní box
                ctx.fillStyle = case_.color;
                ctx.fillRect(case_.x - 50, case_.y - 40, 100, 80);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.strokeRect(case_.x - 50, case_.y - 40, 100, 80);
                
                // Label
                ctx.fillStyle = '#333';
                ctx.font = 'bold 14px Inter';
                ctx.textAlign = 'center';
                ctx.fillText(case_.label, case_.x, case_.y - 10);
                
                // Popis
                const lines = case_.desc.split('\n');
                ctx.font = '10px Inter';
                lines.forEach((line, i) => {
                    ctx.fillText(line, case_.x, case_.y + 5 + i * 12);
                });
            });
            
            // Příklad níže
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('Příklad: Mísič se 2 proudy na vstupu', 250, 220);
            
            // Tabulka příkladu
            ctx.font = '12px Inter';
            ctx.textAlign = 'left';
            ctx.fillText('Neznámé:', 80, 250);
            ctx.fillText('• Průtok produktu: ṁ₃', 90, 270);
            ctx.fillText('• Složení produktu: x₃', 90, 285);
            ctx.fillText('• Teplota produktu: T₃', 90, 300);
            ctx.fillText('CELKEM: 3 neznámé', 90, 320);
            
            ctx.fillText('Rovnice:', 280, 250);
            ctx.fillText('• Celková hmot. bilance', 290, 270);
            ctx.fillText('• Složková bilance', 290, 285);
            ctx.fillText('• Tepelná bilance', 290, 300);
            ctx.fillText('CELKEM: 3 nezávislé', 290, 320);
            
            // Výsledek
            ctx.fillStyle = '#2e7d32';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('DOF = 3 - 3 = 0 → Systém řešitelný!', 250, 350);
            
            // Šipka ukazující na správný případ
            ctx.strokeStyle = '#2e7d32';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(250, 330);
            ctx.lineTo(250, 180);
            ctx.stroke();
            
            // Šipka (hlava)
            ctx.fillStyle = '#2e7d32';
            ctx.beginPath();
            ctx.moveTo(250, 180);
            ctx.lineTo(245, 190);
            ctx.lineTo(255, 190);
            ctx.closePath();
            ctx.fill();
        }

        function drawConversionDiagram() {
            const canvas = document.getElementById('conversionDiagram');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Pozadí
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Příklad reakce N₂ + 3H₂ → 2NH₃
            ctx.fillStyle = '#333';
            ctx.font = 'bold 16px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('Příklad: N₂ + 3H₂ → 2NH₃', 250, 30);
            
            // Vstup
            ctx.fillStyle = '#e3f2fd';
            ctx.fillRect(50, 60, 120, 80);
            ctx.strokeStyle = '#1976d2';
            ctx.lineWidth = 2;
            ctx.strokeRect(50, 60, 120, 80);
            
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('VSTUP', 110, 85);
            ctx.font = '12px Inter';
            ctx.fillText('N₂: 100 mol/s', 110, 105);
            ctx.fillText('H₂: 300 mol/s', 110, 120);
            
            // Reaktor
            ctx.fillStyle = '#fff3e0';
            ctx.fillRect(200, 60, 100, 80);
            ctx.strokeStyle = '#ff9800';
            ctx.lineWidth = 2;
            ctx.strokeRect(200, 60, 100, 80);
            
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Inter';
            ctx.fillText('REAKTOR', 250, 90);
            ctx.font = '12px Inter';
            ctx.fillText('X_N₂ = 0.8', 250, 110);
            ctx.fillText('(80% konverze)', 250, 125);
            
            // Výstup
            ctx.fillStyle = '#e8f5e8';
            ctx.fillRect(330, 60, 120, 80);
            ctx.strokeStyle = '#4caf50';
            ctx.lineWidth = 2;
            ctx.strokeRect(330, 60, 120, 80);
            
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('VÝSTUP', 390, 85);
            ctx.font = '12px Inter';
            ctx.fillText('N₂: 20 mol/s', 390, 105);
            ctx.fillText('H₂: 60 mol/s', 390, 120);
            ctx.fillText('NH₃: 160 mol/s', 390, 135);
            
            // Šipky
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(170, 100);
            ctx.lineTo(200, 100);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(300, 100);
            ctx.lineTo(330, 100);
            ctx.stroke();
            
            // Výpočet
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Inter';
            ctx.textAlign = 'left';
            ctx.fillText('Výpočet:', 50, 180);
            
            ctx.font = '12px Inter';
            ctx.fillText('1. Reakční rozsah: ξ = X_N₂ × n_N₂,in / (-ν_N₂) = 0.8 × 100 / 1 = 80 mol/s', 50, 200);
            ctx.fillText('2. Molární bilance N₂: n_out = 100 - 80 = 20 mol/s', 50, 220);
            ctx.fillText('3. Molární bilance H₂: n_out = 300 - 3×80 = 60 mol/s', 50, 240);
            ctx.fillText('4. Molární bilance NH₃: n_out = 0 + 2×80 = 160 mol/s', 50, 260);
            
            // Graf konverze vs čas (ilustrativní)
            ctx.fillStyle = '#333';
            ctx.font = 'bold 12px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('Typická závislost konverze na čase', 300, 300);
            
            // Jednoduchá křivka
            ctx.strokeStyle = '#d32f2f';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(200, 350);
            for (let x = 200; x <= 400; x += 2) {
                const t = (x - 200) / 200 * 5; // čas 0-5
                const conv = 0.9 * (1 - Math.exp(-0.8 * t)); // exponenciální růst
                const y = 350 - conv * 50; // škálování
                ctx.lineTo(x, y);
            }
            ctx.stroke();
            
            // Osy grafu
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(200, 350);
            ctx.lineTo(400, 350);
            ctx.moveTo(200, 350);
            ctx.lineTo(200, 300);
            ctx.stroke();
            
            ctx.font = '10px Inter';
            ctx.textAlign = 'center';
            ctx.fillText('0', 200, 365);
            ctx.fillText('X_A = 1', 200, 295);
            ctx.fillText('čas', 300, 375);
        }
    </script>
</body>
</html>