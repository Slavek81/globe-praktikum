<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistické zpracování naměřených dat - Matematické praktikum</title>
    <!-- Import pro renderování LaTeX matematických vzorců -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <link rel="stylesheet" href="unified-style.css">

    <style>
        /* Additional styles for statistical content */
        .stats-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 6px solid #bc5090;
        }

        .descriptive-card { border-left-color: #bc5090; }
        .testing-card { border-left-color: #ff6361; }
        .correlation-card { border-left-color: #ffa600; }
        .uncertainty-card { border-left-color: #58508d; }

        .calculator {
            background: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .calc-input {
            width: 100%;
            padding: 0.4rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 0.3rem 0;
            font-size: 0.9rem;
        }

        .calc-result {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: none;
        }

        .calc-result.visible {
            display: block;
        }

        .calc-button {
            background: #ff9800;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 0.5rem;
        }

        .calc-button:hover {
            background: #f57c00;
        }

        .info-box {
            background: #e8f4fd;
            border: 1px solid #2196f3;
            border-left: 4px solid #2196f3;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
        }

        .distribution-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .distribution-item {
            text-align: center;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
        }

        .distribution-item.normal {
            border-color: #4caf50;
            background: #e8f5e8;
        }

        .distribution-item.skewed {
            border-color: #ff9800;
            background: #fff3e0;
        }

        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            font-size: 0.9rem;
        }

        .stats-table th, .stats-table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .stats-table th {
            background: linear-gradient(135deg, #58508d, #bc5090);
            color: white;
            font-weight: bold;
        }

        .stats-table tbody tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <main>
        <header>
            <h1>Statistické zpracování naměřených dat</h1>
            <p>Interaktivní průvodce pro analýzu experimentálních dat v přírodních vědách</p>
        </header>

        <section class="intro-box">
            <h2>Proč je statistika důležitá v experimentální práci?</h2>
            <p>Při každém experimentu nebo měření se setkáváme s <strong>variabilitou dat</strong> a <strong>nejistotami měření</strong>. Statistika nám pomáhá pochopit, co naše data znamenají, jak spolehlivé jsou naše závěry a jak velké jsou chyby našich měření.</p>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
                <div style="background: linear-gradient(135deg, #bc5090, #ff6361); color: white; padding: 2rem; border-radius: 12px; text-align: center;">
                    <h3 style="color: white; margin-bottom: 1rem; font-size: 1.3rem;">📊 DESKRIPTIVNÍ STATISTIKA</h3>
                    <p style="font-size: 1rem; margin-bottom: 0.5rem;">Průměr, rozptyl, směrodatná odchylka</p>
                    <p style="font-size: 0.9rem; opacity: 0.9;">Základní charakteristiky dat</p>
                </div>
                <div style="background: linear-gradient(135deg, #ffa600, #58508d); color: white; padding: 2rem; border-radius: 12px; text-align: center;">
                    <h3 style="color: white; margin-bottom: 1rem; font-size: 1.3rem;">🔬 TESTOVÁNÍ HYPOTÉZ</h3>
                    <p style="font-size: 1rem; margin-bottom: 0.5rem;">t-test, χ² test, analýza rozptylu</p>
                    <p style="font-size: 0.9rem; opacity: 0.9;">Statistická významnost</p>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 1rem 0;">
                <div style="background: linear-gradient(135deg, #ff6361, #ffa600); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">📈 KORELACE</h3>
                    <p style="font-size: 0.9rem; opacity: 0.9;">Závislosti mezi proměnnými</p>
                </div>
                <div style="background: linear-gradient(135deg, #58508d, #003f5c); color: white; padding: 1.5rem; border-radius: 12px; text-align: center;">
                    <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1.2rem;">🎯 NEJISTOTY</h3>
                    <p style="font-size: 0.9rem; opacity: 0.9;">Propagace chyb měření</p>
                </div>
            </div>
        </section>

        <!-- Descriptive Statistics -->
        <section class="unit-section">
            <h2>1. Deskriptivní statistika</h2>
            <p><strong>Princip:</strong> Základní statistické charakteristiky popisují naměřená data pomocí číselných hodnot. Umožňují nám rychle pochopit centrum, variabilitu a distribuci dat.</p>

            <div class="equations">
                <h3>Míry centrální tendence</h3>
                <p><strong>Aritmetický průměr:</strong> Nejčastěji používaná míra středu
                $$ \bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i $$</p>

                <p><strong>Medián:</strong> Střední hodnota seřazených dat - odolný vůči odlehlým hodnotám</p>

                <p><strong>Modus:</strong> Nejčastější hodnota v datovém souboru</p>

                <h3>Míry variability</h3>
                <p><strong>Výběrový rozptyl:</strong> Míra rozptylu dat kolem průměru
                $$ s^2 = \frac{1}{n-1}\sum_{i=1}^{n} (x_i - \bar{x})^2 $$</p>

                <p><strong>Směrodatná odchylka:</strong> Kvadratický kořen z rozptylu
                $$ s = \sqrt{s^2} $$</p>

                <p><strong>Variační koeficient:</strong> Relativní míra variability
                $$ CV = \frac{s}{\bar{x}} \times 100\% $$</p>
            </div>

            <div class="calculator">
                <h4>Kalkulátor deskriptivní statistiky</h4>
                <label>Data (oddělená čárkami):</label>
                <input type="text" id="desc-stats-data" class="calc-input"
                       value="4.2, 3.8, 4.1, 3.9, 4.3, 4.0, 3.7, 4.2, 4.1, 3.8">
                <button class="calc-button" onclick="calculateDescriptiveStats()">Vypočítej statistiky</button>
                <div id="desc-stats-result" class="calc-result"></div>
            </div>

            <div class="example">
                <h3>Vizualizace dat</h3>
                <div style="background: white; border-radius: 12px; padding: 1rem; margin: 1rem 0; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 2px solid #58508d;">
                    <div id="descriptive-stats" style="height: 400px;"></div>
                </div>
            </div>
        </section>

        <!-- Normal Distribution -->
        <section class="unit-section">
            <h2>2. Normální rozdělení a jeho vlastnosti</h2>
            <p><strong>Princip:</strong> Normální (Gaussovo) rozdělení je nejdůležitější rozdělení pravděpodobnosti v statistice. Mnoho přírodních jevů se řídí normálním rozdělením.</p>

            <div class="equations">
                <h3>Gaussova hustota pravděpodobnosti</h3>
                <p><strong>Matematická forma:</strong>
                $$ f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2} $$
                kde μ je střední hodnota a σ je směrodatná odchylka</p>

                <h3>Empirické pravidlo (68-95-99.7)</h3>
                <ul>
                    <li><strong>68%</strong> dat leží v intervalu μ ± σ</li>
                    <li><strong>95%</strong> dat leží v intervalu μ ± 2σ</li>
                    <li><strong>99.7%</strong> dat leží v intervalu μ ± 3σ</li>
                </ul>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
                <div class="distribution-item normal">
                    <h4>Normální rozdělení</h4>
                    <p><strong>Vlastnosti:</strong></p>
                    <ul style="text-align: left;">
                        <li>Symetrické kolem střední hodnoty</li>
                        <li>Průměr = Medián = Modus</li>
                        <li>Zvonový tvar křivky</li>
                        <li>Asymptoticky blíží se k ose x</li>
                    </ul>
                </div>
                <div class="distribution-item skewed">
                    <h4>Zešikmené rozdělení</h4>
                    <p><strong>Vlastnosti:</strong></p>
                    <ul style="text-align: left;">
                        <li>Asymetrické</li>
                        <li>Průměr ≠ Medián</li>
                        <li>Dlouhý "ocas" na jedné straně</li>
                        <li>Často u přírodních dat</li>
                    </ul>
                </div>
            </div>

            <div class="warning-box">
                <h4>⚠️ Pozor na odlehlé hodnoty!</h4>
                <p>Odlehlé hodnoty silně ovlivňují průměr a směrodatnou odchylku. Při jejich přítomnosti je lepší použít medián a kvartilové rozpětí jako robustní statistiky.</p>
            </div>

            <div class="example">
                <h3>Vizualizace normálního rozdělení</h3>
                <div style="background: white; border-radius: 12px; padding: 1rem; margin: 1rem 0; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 2px solid #58508d;">
                    <div id="normal-distribution" style="height: 400px;"></div>
                </div>
            </div>
        </section>

        <!-- Hypothesis Testing -->
        <section class="unit-section">
            <h2>3. Testování hypotéz</h2>
            <p><strong>Princip:</strong> Testování hypotéz je formální postup pro rozhodování o platnosti tvrzení na základě naměřených dat. Pomáhá nám odpovědět na otázky typu "Je rozdíl mezi skupinami statisticky významný?"</p>

            <div class="equations">
                <h3>Základní koncepty</h3>
                <ul>
                    <li><strong>H₀ (nulová hypotéza):</strong> Předpoklad, který testujeme (např. "rozdíl neexistuje")</li>
                    <li><strong>H₁ (alternativní hypotéza):</strong> To, co chceme prokázat</li>
                    <li><strong>α (hladina významnosti):</strong> Pravděpodobnost chyby I. druhu (obvykle 0.05)</li>
                    <li><strong>p-hodnota:</strong> Pravděpodobnost pozorování dat za předpokladu platnosti H₀</li>
                </ul>

                <h3>Jednovýběrový t-test</h3>
                <p><strong>Testuje, zda průměr výběru se liší od teoretické hodnoty μ₀:</strong>
                $$ t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} $$
                kde n je počet pozorování</p>

                <h4>Rozhodovací pravidlo:</h4>
                <p>Pokud p-hodnota < α, zamítáme H₀ ve prospěch H₁</p>
            </div>

            <div class="calculator">
                <h4>Kalkulátor jednovýběrového t-testu</h4>
                <label>Data (oddělená čárkami):</label>
                <input type="text" id="ttest-data" class="calc-input"
                       value="4.1, 4.3, 4.0, 4.2, 4.1, 3.9, 4.2">
                <label>Teoretická hodnota μ₀:</label>
                <input type="number" id="mu0" class="calc-input" value="4.0" step="0.1">
                <label>Hladina významnosti α:</label>
                <input type="number" id="alpha" class="calc-input" value="0.05" step="0.01">
                <button class="calc-button" onclick="calculateTTest()">Vypočítej t-test</button>
                <div id="ttest-result" class="calc-result"></div>
            </div>

            <div class="info-box">
                <h4>Interpretace p-hodnoty</h4>
                <table class="stats-table">
                    <thead>
                        <tr><th>p-hodnota</th><th>Interpretace</th><th>Rozhodnutí</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>p < 0.001</td><td>Velmi silný důkaz proti H₀</td><td>Zamítnout H₀</td></tr>
                        <tr><td>0.001 ≤ p < 0.01</td><td>Silný důkaz proti H₀</td><td>Zamítnout H₀</td></tr>
                        <tr><td>0.01 ≤ p < 0.05</td><td>Mírný důkaz proti H₀</td><td>Zamítnout H₀</td></tr>
                        <tr><td>0.05 ≤ p < 0.1</td><td>Slabý důkaz proti H₀</td><td>Nezamítnout H₀</td></tr>
                        <tr><td>p ≥ 0.1</td><td>Žádný důkaz proti H₀</td><td>Nezamítnout H₀</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Correlation Analysis -->
        <section class="unit-section">
            <h2>4. Korelační analýza</h2>
            <p><strong>Princip:</strong> Korelační analýza zkoumá sílu a směr lineární závislosti mezi dvěma proměnnými. Je klíčová pro pochopení vztahů v experimentálních datech.</p>

            <div class="equations">
                <h3>Pearsonův korelační koeficient</h3>
                <p><strong>Vzorec:</strong>
                $$ r = \frac{\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^{n}(x_i - \bar{x})^2 \sum_{i=1}^{n}(y_i - \bar{y})^2}} $$</p>

                <h4>Interpretace korelačního koeficientu</h4>
                <ul>
                    <li><strong>r = 1:</strong> Dokonalá pozitivní korelace</li>
                    <li><strong>0.7 < |r| < 1:</strong> Silná korelace</li>
                    <li><strong>0.3 < |r| ≤ 0.7:</strong> Střední korelace</li>
                    <li><strong>0 < |r| ≤ 0.3:</strong> Slabá korelace</li>
                    <li><strong>r = 0:</strong> Žádná lineární korelace</li>
                    <li><strong>r = -1:</strong> Dokonalá negativní korelace</li>
                </ul>
            </div>

            <div class="calculator">
                <h4>Kalkulátor korelace</h4>
                <label>Data X (oddělená čárkami):</label>
                <input type="text" id="corr-x-data" class="calc-input"
                       value="1, 2, 3, 4, 5, 6, 7, 8, 9, 10">
                <label>Data Y (oddělená čárkami):</label>
                <input type="text" id="corr-y-data" class="calc-input"
                       value="2.1, 3.9, 6.2, 7.8, 10.1, 12.3, 13.8, 16.1, 18.2, 20.0">
                <button class="calc-button" onclick="calculateCorrelation()">Vypočítej korelaci</button>
                <div id="correlation-result" class="calc-result"></div>
            </div>

            <div class="warning-box">
                <h4>⚠️ Korelace ≠ Kauzalita</h4>
                <p>Vysoká korelace neznamená, že jedna proměnná způsobuje změnu druhé. Může to být způsobeno třetí proměnnou nebo náhodou. Vždy je potřeba další analýza pro prokázání příčinné souvislosti.</p>
            </div>

            <div class="example">
                <h3>Vizualizace korelace</h3>
                <div style="background: white; border-radius: 12px; padding: 1rem; margin: 1rem 0; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 2px solid #58508d;">
                    <div id="correlation-plot" style="height: 400px;"></div>
                </div>
            </div>
        </section>

        <!-- Uncertainty Propagation -->
        <section class="unit-section">
            <h2>5. Propagace nejistot měření</h2>
            <p><strong>Princip:</strong> Každé měření má svou nejistotu. Když kombinujeme měření v výpočtech, musíme správně propagovat (šířit) tyto nejistoty k výslednému výpočtu.</p>

            <div class="equations">
                <h3>Základní pravidla propagace nejistot</h3>

                <h4>Pro nezávislé veličiny A a B s nejistotami δA a δB:</h4>

                <p><strong>Sčítání a odčítání:</strong>
                $$ Z = A \pm B $$
                $$ \delta Z = \sqrt{(\delta A)^2 + (\delta B)^2} $$</p>

                <p><strong>Násobení a dělení:</strong>
                $$ Z = A \times B \quad \text{nebo} \quad Z = A / B $$
                $$ \frac{\delta Z}{Z} = \sqrt{\left(\frac{\delta A}{A}\right)^2 + \left(\frac{\delta B}{B}\right)^2} $$</p>

                <p><strong>Umocňování:</strong>
                $$ Z = A^n $$
                $$ \frac{\delta Z}{Z} = |n| \frac{\delta A}{A} $$</p>

                <h4>Obecný vzorec (parciální derivace)</h4>
                <p>Pro funkci \(Z = f(A, B, C, ...)\):
                $$ \delta Z = \sqrt{\left(\frac{\partial f}{\partial A}\delta A\right)^2 + \left(\frac{\partial f}{\partial B}\delta B\right)^2 + \left(\frac{\partial f}{\partial C}\delta C\right)^2 + ...} $$</p>
            </div>

            <div class="calculator">
                <h4>Kalkulátor propagace nejistot</h4>
                <p>Příklad: Z = A × B</p>
                <label>Hodnota A:</label>
                <input type="number" id="val-a" class="calc-input" value="4.5" step="0.1">
                <label>Nejistota δA:</label>
                <input type="number" id="unc-a" class="calc-input" value="0.2" step="0.01">
                <label>Hodnota B:</label>
                <input type="number" id="val-b" class="calc-input" value="3.2" step="0.1">
                <label>Nejistota δB:</label>
                <input type="number" id="unc-b" class="calc-input" value="0.1" step="0.01">
                <button class="calc-button" onclick="calculateUncertaintyPropagation()">Vypočítej propagaci</button>
                <div id="uncertainty-result" class="calc-result"></div>
            </div>

            <div class="info-box">
                <h4>Praktické aplikace</h4>
                <ul>
                    <li><strong>Hustota:</strong> ρ = m/V → δρ/ρ = √((δm/m)² + (δV/V)²)</li>
                    <li><strong>Rychlost:</strong> v = s/t → δv/v = √((δs/s)² + (δt/t)²)</li>
                    <li><strong>Plocha kruhu:</strong> S = πr² → δS/S = 2(δr/r)</li>
                    <li><strong>Kinetická energie:</strong> E = ½mv² → δE/E = √((δm/m)² + (2δv/v)²)</li>
                </ul>
            </div>
        </section>

        <!-- Summary and Best Practices -->
        <section class="unit-section">
            <h2>6. Shrnutí a praktická doporučení</h2>

            <h3>Postup statistické analýzy dat</h3>
            <div class="info-box">
                <h4>Doporučený workflow</h4>
                <ol>
                    <li><strong>Explorační analýza:</strong> Histogramy, box-ploty, základní statistiky</li>
                    <li><strong>Kontrola předpokladů:</strong> Normalita, odlehlé hodnoty, homogenita rozptylu</li>
                    <li><strong>Volba testu:</strong> Na základě typu dat a otázky</li>
                    <li><strong>Provedení testu:</strong> Výpočet statistiky a p-hodnoty</li>
                    <li><strong>Interpretace:</strong> Závěr v kontextu problému</li>
                </ol>
            </div>

            <h3>Časté chyby a jak se jim vyhnout</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
                <div class="warning-box">
                    <h4>❌ Časté chyby</h4>
                    <ul>
                        <li>Ignorování odlehlých hodnot</li>
                        <li>Neověření normality dat</li>
                        <li>Záměna korelace za kauzalitu</li>
                        <li>Nesprávná interpretace p-hodnoty</li>
                        <li>Opakované testování bez korekce</li>
                    </ul>
                </div>
                <div class="info-box">
                    <h4>✅ Dobrá praxe</h4>
                    <ul>
                        <li>Vždy vizualizuj data před analýzou</li>
                        <li>Používej robustní statistiky při odlehlých hodnotách</li>
                        <li>Uváděj vždy doporučení intervalů</li>
                        <li>Dokumentuj všechny kroky analýzy</li>
                        <li>Konzultuj s expertem při složitějších analýzách</li>
                    </ul>
                </div>
            </div>

            <h3>Volba správné statistické metody</h3>
            <table class="stats-table">
                <thead>
                    <tr><th>Typ dat</th><th>Otázka</th><th>Doporučená metoda</th></tr>
                </thead>
                <tbody>
                    <tr><td>Spojitá, 1 skupina</td><td>Liší se průměr od teoretické hodnoty?</td><td>Jednovýběrový t-test</td></tr>
                    <tr><td>Spojitá, 2 skupiny</td><td>Liší se průměry dvou skupin?</td><td>Dvouvýběrový t-test</td></tr>
                    <tr><td>Spojitá, 3+ skupin</td><td>Liší se průměry více skupin?</td><td>ANOVA</td></tr>
                    <tr><td>Kategoriální</td><td>Liší se proporce od očekávaných?</td><td>χ² test</td></tr>
                    <tr><td>Spojitá, 2 proměnné</td><td>Existuje lineární vztah?</td><td>Korelační analýza</td></tr>
                </tbody>
            </table>
        </section>

    </main>

    <script>
        // Configure MathJax
        window.MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['$$', '$$']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };

        // Statistical calculation functions
        function calculateDescriptiveStats() {
            const input = document.getElementById('desc-stats-data').value;
            const data = input.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));

            if (data.length === 0) {
                alert('Zadejte platná číselná data oddělená čárkami');
                return;
            }

            // Basic statistics
            const n = data.length;
            const mean = data.reduce((sum, x) => sum + x, 0) / n;

            // Sort for median
            const sorted = [...data].sort((a, b) => a - b);
            const median = n % 2 === 0 ?
                (sorted[n/2 - 1] + sorted[n/2]) / 2 :
                sorted[Math.floor(n/2)];

            // Variance and standard deviation
            const variance = data.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0) / (n - 1);
            const stdDev = Math.sqrt(variance);

            // Coefficient of variation
            const cv = (stdDev / mean) * 100;

            // Range
            const min = Math.min(...data);
            const max = Math.max(...data);
            const range = max - min;

            const result = document.getElementById('desc-stats-result');
            result.innerHTML = `
                <h4>Výsledky deskriptivní statistiky:</h4>
                <table class="stats-table">
                    <tbody>
                        <tr><td><strong>Počet hodnot (n)</strong></td><td>${n}</td></tr>
                        <tr><td><strong>Aritmetický průměr</strong></td><td>${mean.toFixed(3)}</td></tr>
                        <tr><td><strong>Medián</strong></td><td>${median.toFixed(3)}</td></tr>
                        <tr><td><strong>Minimum</strong></td><td>${min.toFixed(3)}</td></tr>
                        <tr><td><strong>Maximum</strong></td><td>${max.toFixed(3)}</td></tr>
                        <tr><td><strong>Rozpětí</strong></td><td>${range.toFixed(3)}</td></tr>
                        <tr><td><strong>Rozptyl (s²)</strong></td><td>${variance.toFixed(4)}</td></tr>
                        <tr><td><strong>Směrodatná odchylka (s)</strong></td><td>${stdDev.toFixed(3)}</td></tr>
                        <tr><td><strong>Variační koeficient</strong></td><td>${cv.toFixed(1)}%</td></tr>
                    </tbody>
                </table>
            `;
            result.classList.add('visible');

            // Update graph
            createDescriptiveStatsGraph(data, mean, stdDev);
        }

        function calculateTTest() {
            const input = document.getElementById('ttest-data').value;
            const mu0 = parseFloat(document.getElementById('mu0').value);
            const alpha = parseFloat(document.getElementById('alpha').value);

            const data = input.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));

            if (data.length === 0) {
                alert('Zadejte platná číselná data oddělená čárkami');
                return;
            }

            const n = data.length;
            const mean = data.reduce((sum, x) => sum + x, 0) / n;
            const variance = data.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0) / (n - 1);
            const stdDev = Math.sqrt(variance);
            const standardError = stdDev / Math.sqrt(n);

            // t-statistic
            const t = (mean - mu0) / standardError;
            const df = n - 1;

            // Approximate p-value (two-tailed)
            // This is a simplified calculation
            const pValue = 2 * (1 - cumulativeTDistribution(Math.abs(t), df));

            const result = document.getElementById('ttest-result');
            result.innerHTML = `
                <h4>Výsledky jednovýběrového t-testu:</h4>
                <table class="stats-table">
                    <tbody>
                        <tr><td><strong>Nulová hypotéza H₀</strong></td><td>μ = ${mu0}</td></tr>
                        <tr><td><strong>Alternativní hypotéza H₁</strong></td><td>μ ≠ ${mu0}</td></tr>
                        <tr><td><strong>Výběrový průměr</strong></td><td>${mean.toFixed(3)}</td></tr>
                        <tr><td><strong>Směrodatná chyba</strong></td><td>${standardError.toFixed(3)}</td></tr>
                        <tr><td><strong>t-statistika</strong></td><td>${t.toFixed(3)}</td></tr>
                        <tr><td><strong>Stupně volnosti</strong></td><td>${df}</td></tr>
                        <tr><td><strong>p-hodnota</strong></td><td>${pValue.toFixed(4)}</td></tr>
                        <tr><td><strong>Rozhodnutí (α = ${alpha})</strong></td><td>
                            ${pValue < alpha ? '<span style="color: red;">Zamítnout H₀</span>' : '<span style="color: green;">Nezamítnout H₀</span>'}
                        </td></tr>
                    </tbody>
                </table>
                <p><strong>Interpretace:</strong> ${pValue < alpha ?
                    'Existuje statisticky významný rozdíl mezi výběrovým průměrem a teoretickou hodnotou.' :
                    'Neexistuje statisticky významný rozdíl mezi výběrovým průměrem a teoretickou hodnotou.'}</p>
            `;
            result.classList.add('visible');
        }

        function calculateCorrelation() {
            const xInput = document.getElementById('corr-x-data').value;
            const yInput = document.getElementById('corr-y-data').value;

            const xData = xInput.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
            const yData = yInput.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));

            if (xData.length === 0 || yData.length === 0 || xData.length !== yData.length) {
                alert('Zadejte stejný počet platných číselných hodnot pro obě proměnné');
                return;
            }

            const n = xData.length;
            const xMean = xData.reduce((sum, x) => sum + x, 0) / n;
            const yMean = yData.reduce((sum, y) => sum + y, 0) / n;

            const numerator = xData.reduce((sum, x, i) => sum + (x - xMean) * (yData[i] - yMean), 0);
            const xSumSq = xData.reduce((sum, x) => sum + Math.pow(x - xMean, 2), 0);
            const ySumSq = yData.reduce((sum, y) => sum + Math.pow(y - yMean, 2), 0);

            const correlation = numerator / Math.sqrt(xSumSq * ySumSq);

            // Interpretation
            let interpretation = '';
            const absCorr = Math.abs(correlation);
            if (absCorr >= 0.9) interpretation = 'Velmi silná korelace';
            else if (absCorr >= 0.7) interpretation = 'Silná korelace';
            else if (absCorr >= 0.5) interpretation = 'Střední korelace';
            else if (absCorr >= 0.3) interpretation = 'Slabá korelace';
            else interpretation = 'Zanedbatelná korelace';

            const result = document.getElementById('correlation-result');
            result.innerHTML = `
                <h4>Výsledky korelační analýzy:</h4>
                <table class="stats-table">
                    <tbody>
                        <tr><td><strong>Pearsonův korelační koeficient (r)</strong></td><td>${correlation.toFixed(3)}</td></tr>
                        <tr><td><strong>Koeficient determinace (r²)</strong></td><td>${(correlation * correlation).toFixed(3)}</td></tr>
                        <tr><td><strong>Interpretace</strong></td><td>${interpretation}</td></tr>
                        <tr><td><strong>Směr vztahu</strong></td><td>${correlation > 0 ? 'Pozitivní' : correlation < 0 ? 'Negativní' : 'Žádný'}</td></tr>
                    </tbody>
                </table>
                <p><strong>Vysvětleno:</strong> ${(correlation * correlation * 100).toFixed(1)}% variability proměnné Y je vysvětleno proměnnou X.</p>
            `;
            result.classList.add('visible');

            // Update correlation plot
            createCorrelationPlot(xData, yData, correlation);
        }

        function calculateUncertaintyPropagation() {
            const valA = parseFloat(document.getElementById('val-a').value);
            const uncA = parseFloat(document.getElementById('unc-a').value);
            const valB = parseFloat(document.getElementById('val-b').value);
            const uncB = parseFloat(document.getElementById('unc-b').value);

            // Z = A × B
            const z = valA * valB;
            const relUncA = uncA / valA;
            const relUncB = uncB / valB;
            const relUncZ = Math.sqrt(relUncA * relUncA + relUncB * relUncB);
            const uncZ = relUncZ * z;

            const result = document.getElementById('uncertainty-result');
            result.innerHTML = `
                <h4>Propagace nejistot pro Z = A × B:</h4>
                <table class="stats-table">
                    <tbody>
                        <tr><td><strong>A</strong></td><td>${valA} ± ${uncA}</td></tr>
                        <tr><td><strong>B</strong></td><td>${valB} ± ${uncB}</td></tr>
                        <tr><td><strong>Z = A × B</strong></td><td>${z.toFixed(3)} ± ${uncZ.toFixed(3)}</td></tr>
                        <tr><td><strong>Relativní nejistota Z</strong></td><td>${(relUncZ * 100).toFixed(2)}%</td></tr>
                    </tbody>
                </table>
                <p><strong>Výpočet:</strong></p>
                <p>δZ/Z = √((δA/A)² + (δB/B)²) = √((${uncA}/${valA})² + (${uncB}/${valB})²) = ${relUncZ.toFixed(4)}</p>
                <p>δZ = (δZ/Z) × Z = ${relUncZ.toFixed(4)} × ${z.toFixed(3)} = ${uncZ.toFixed(3)}</p>
            `;
            result.classList.add('visible');
        }

        // Helper function for t-distribution (simplified approximation)
        function cumulativeTDistribution(t, df) {
            // This is a very simplified approximation
            // In practice, you would use a more accurate implementation
            if (df > 30) {
                // Approximate with normal distribution for large df
                return 0.5 * (1 + erf(t / Math.sqrt(2)));
            }

            // Very rough approximation for small df
            const x = t / Math.sqrt(df);
            return 0.5 + 0.5 * Math.tanh(x * 0.8);
        }

        function erf(x) {
            // Approximation of error function
            const a1 =  0.254829592;
            const a2 = -0.284496736;
            const a3 =  1.421413741;
            const a4 = -1.453152027;
            const a5 =  1.061405429;
            const p  =  0.3275911;

            const sign = x >= 0 ? 1 : -1;
            x = Math.abs(x);

            const t = 1.0 / (1.0 + p * x);
            const y = 1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * Math.exp(-x * x);

            return sign * y;
        }

        // Graph creation functions
        function createDescriptiveStatsGraph(data, mean, stdDev) {
            const traces = [
                {
                    x: data,
                    type: 'histogram',
                    nbinsx: Math.max(5, Math.floor(Math.sqrt(data.length))),
                    name: 'Histogram dat',
                    marker: {
                        color: '#bc5090',
                        line: {
                            color: '#58508d',
                            width: 1
                        }
                    }
                }
            ];

            const layout = {
                title: 'Histogram naměřených dat',
                xaxis: {title: 'Hodnota'},
                yaxis: {title: 'Četnost'},
                showlegend: false,
                shapes: [
                    {
                        type: 'line',
                        x0: mean,
                        x1: mean,
                        y0: 0,
                        y1: 1,
                        yref: 'paper',
                        line: {
                            color: 'red',
                            width: 3,
                            dash: 'dash'
                        }
                    }
                ],
                annotations: [
                    {
                        x: mean,
                        y: 0.9,
                        yref: 'paper',
                        text: `Průměr: ${mean.toFixed(2)}`,
                        showarrow: true,
                        arrowhead: 2,
                        ax: 20,
                        ay: -30
                    }
                ],
                margin: {l: 40, r: 40, t: 40, b: 40}
            };

            Plotly.newPlot('descriptive-stats', traces, layout, {responsive: true});
        }

        function createNormalDistribution() {
            const x = [];
            const y1 = []; // Standard normal
            const y2 = []; // Normal with different parameters

            for (let i = -4; i <= 4; i += 0.1) {
                x.push(i);
                y1.push(Math.exp(-0.5 * i * i) / Math.sqrt(2 * Math.PI));
                y2.push(0.8 * Math.exp(-0.5 * Math.pow((i - 1)/1.5, 2)) / (1.5 * Math.sqrt(2 * Math.PI)));
            }

            const traces = [
                {
                    x: x,
                    y: y1,
                    mode: 'lines',
                    name: 'N(0,1)',
                    line: {color: '#bc5090', width: 3}
                },
                {
                    x: x,
                    y: y2,
                    mode: 'lines',
                    name: 'N(1,1.5)',
                    line: {color: '#ffa600', width: 3}
                }
            ];

            const layout = {
                title: 'Normální rozdělení s různými parametry',
                xaxis: {title: 'x'},
                yaxis: {title: 'Hustota pravděpodobnosti'},
                showlegend: true,
                margin: {l: 40, r: 40, t: 40, b: 40}
            };

            Plotly.newPlot('normal-distribution', traces, layout, {responsive: true});
        }

        function createCorrelationPlot(xData, yData, correlation) {
            // Calculate regression line
            const n = xData.length;
            const xMean = xData.reduce((sum, x) => sum + x, 0) / n;
            const yMean = yData.reduce((sum, y) => sum + y, 0) / n;

            const numerator = xData.reduce((sum, x, i) => sum + (x - xMean) * (yData[i] - yMean), 0);
            const denominator = xData.reduce((sum, x) => sum + Math.pow(x - xMean, 2), 0);
            const slope = numerator / denominator;
            const intercept = yMean - slope * xMean;

            const xMin = Math.min(...xData);
            const xMax = Math.max(...xData);
            const regressionX = [xMin, xMax];
            const regressionY = [slope * xMin + intercept, slope * xMax + intercept];

            const traces = [
                {
                    x: xData,
                    y: yData,
                    mode: 'markers',
                    name: 'Data',
                    marker: {
                        color: '#58508d',
                        size: 8
                    }
                },
                {
                    x: regressionX,
                    y: regressionY,
                    mode: 'lines',
                    name: `Regresní přímka (r=${correlation.toFixed(3)})`,
                    line: {
                        color: '#ff6361',
                        width: 2
                    }
                }
            ];

            const layout = {
                title: 'Korelační diagram',
                xaxis: {title: 'X'},
                yaxis: {title: 'Y'},
                showlegend: true,
                margin: {l: 40, r: 40, t: 40, b: 40}
            };

            Plotly.newPlot('correlation-plot', traces, layout, {responsive: true});
        }

        // Initialize graphs when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                createNormalDistribution();
                // Create initial descriptive stats graph with default data
                const defaultData = [4.2, 3.8, 4.1, 3.9, 4.3, 4.0, 3.7, 4.2, 4.1, 3.8];
                const mean = defaultData.reduce((sum, x) => sum + x, 0) / defaultData.length;
                const variance = defaultData.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0) / (defaultData.length - 1);
                const stdDev = Math.sqrt(variance);
                createDescriptiveStatsGraph(defaultData, mean, stdDev);

                // Create initial correlation plot
                const xData = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
                const yData = [2.1, 3.9, 6.2, 7.8, 10.1, 12.3, 13.8, 16.1, 18.2, 20.0];
                createCorrelationPlot(xData, yData, 0.995);
            }, 100);
        });
    </script>
</body>
</html>